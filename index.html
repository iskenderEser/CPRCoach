<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes, viewport-fit=cover" />
  <title>FAST CPR KOÃ‡U</title>
  <script src="https://unpkg.com/pdfmake@0.2.7/build/pdfmake.min.js"></script>
  <script src="https://unpkg.com/pdfmake@0.2.7/build/vfs_fonts.js"></script>
  
  <style>
    /* TÃœM CSS KODU BURADA */
    :root{
      --bg:#ffffff;
      --text:#111;
      --muted:#666;
      --border:#e6e6e6;
      --soft:#fafafa;
      --accent:#0b5fff;
      --ok:#137333;
      --warn:#b06000;
      --bad:#b3261e;
      --shadow: 0 10px 30px rgba(0,0,0,0.06);
      --radius:16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --touch-target: 44px;
      --mobile-padding: 12px;
      --keyboard-safe: env(safe-area-inset-bottom, 0px);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      background:var(--bg);
      color:var(--text);
      padding:20px 14px calc(60px + var(--keyboard-safe));
      padding-left: max(14px, env(safe-area-inset-left));
      padding-right: max(14px, env(safe-area-inset-right));
    }
    
    /* ğŸ“± MOBÄ°L OPTÄ°MÄ°ZASYONU */
    @media (max-width: 768px) {
      body {
        padding: var(--mobile-padding) var(--mobile-padding) calc(50px + var(--keyboard-safe));
        font-size: 15px;
      }
      
      .container {
        max-width: 100%;
        padding: 0;
      }
      
      button, 
      .btn,
      [role="button"],
      .voice-btn,
      .mobile-toolbar button {
        min-height: var(--touch-target);
        min-width: var(--touch-target);
        padding: 12px 16px !important;
      }
      
      details.acc summary {
        padding: 16px 14px;
      }
      
      textarea:focus {
        padding-bottom: calc(1em + var(--keyboard-safe));
      }
      
      .mobile-toolbar {
        display: flex !important;
      }
      
      .two {
        grid-template-columns: 1fr;
        gap: 16px;
      }
      
      h1 {
        font-size: 20px;
      }
      
      .sub {
        font-size: 14px;
      }
    }
    
    @media (max-width: 768px) and (orientation: landscape) {
      body {
        padding-top: 8px;
        padding-bottom: 8px;
      }
      
      .container {
        max-height: 85vh;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      header {
        position: sticky;
        top: 0;
        background: var(--bg);
        z-index: 100;
        padding: 8px 0;
      }
    }
    
    @media (max-width: 360px) {
      :root {
        --radius: 12px;
        --mobile-padding: 10px;
      }
      
      .card, .presetCard, details.acc {
        border-radius: var(--radius);
      }
      
      textarea {
        font-size: 16px !important;
      }
    }
    
    /* =========================================== */
    /* ğŸ“Œ TÃœM TEMEL CPR KARTI - TUTARLI GÃ–RSEL DÄ°L */
    /* =========================================== */
    
    /* 1. TÃœM BÃ–LÃœMLER Ä°Ã‡Ä°N ORTAK KART STÄ°LÄ° */
    .cpr-section-card {
      border: 2px solid #e5e7eb;
      border-radius: 14px;
      padding: 18px 16px 12px 16px;
      background: #f8fafc;
      margin-bottom: 20px;
      position: relative;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.04);
    }
    
    /* 2. BÃ–LÃœM BAÅLIK ETÄ°KETLERÄ° */
    .cpr-section-card::before {
      position: absolute;
      top: -10px;
      left: 16px;
      background: white;
      padding: 4px 10px;
      font-size: 11px;
      font-weight: 600;
      color: #4b5563;
      border: 1px solid #e5e7eb;
      border-radius: 20px;
      letter-spacing: 0.02em;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    /* 3. Ã–ZEL BÃ–LÃœM ETÄ°KETLERÄ° */
    .cpr-section-card[data-section="claim"]::before {
      content: "ğŸ” CLAIM (Problem & Etki)";
    }
    
    .cpr-section-card[data-section="feature"]::before {
      content: "âš™ï¸ PROPOSITION - Ã–zellik";
    }
    
    .cpr-section-card[data-section="advantage"]::before {
      content: "ğŸ† PROPOSITION - Avantaj";
    }
    
    .cpr-section-card[data-section="benefit"]::before {
      content: "â¤ï¸ PROPOSITION - Fayda";
    }
    
    .cpr-section-card[data-section="recommendation"]::before {
      content: "ğŸ¯ RECOMMENDATION";
    }
    
    /* 4. LABEL STÄ°LLERÄ° (TÃ¼m bÃ¶lÃ¼mler iÃ§in) */
    .cpr-section-card label {
      display: block;
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 12px;
      color: #111827;
      padding-left: 0;
    }
    
    /* 5. TEXTAREA STÄ°LLERÄ° (TÃ¼m bÃ¶lÃ¼mler iÃ§in) */
    .cpr-section-card textarea {
      background: white;
      border: 1px solid #d1d5db;
      border-radius: 10px;
      padding: 12px 40px 12px 12px;
      font-size: 14px;
      min-height: 80px;
      width: 100%;
      transition: all 0.2s;
      line-height: 1.5;
      resize: vertical;
      position: relative;
    }
    
    .cpr-section-card textarea:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      background: #f8fafc;
      outline: none;
    }
    
    /* 6. SES BUTONU STÄ°LÄ° (TÃ¼m bÃ¶lÃ¼mler iÃ§in) */
    .cpr-section-card .voice-btn {
      position: absolute;
      right: 12px;
      bottom: 12px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      transition: all 0.2s;
      z-index: 10;
    }
    
    .cpr-section-card .voice-btn:hover {
      background: #2563eb;
      transform: scale(1.1);
    }
    
    .cpr-section-card .voice-btn.listening {
      background: #ef4444;
      animation: pulse 1.5s infinite;
    }
    
    /* Textarea wrapper */
    .cpr-section-card .textarea-wrapper {
      position: relative;
    }
    
    /* 7. CLAIM Ã–ZEL STÄ°LLERÄ° (Problem & Etki ayrÄ±mÄ±) */
    .claim-group {
      border: none;
      padding: 0;
      background: transparent;
      box-shadow: none;
      margin-bottom: 0;
    }
    
    .claim-group::before {
      display: none;
    }
    
    .claim-step {
      position: relative;
      padding-left: 0 !important;
      margin-bottom: 16px;
    }
    
    .claim-step::before {
      display: none !important;
    }
    
    .claim-step:last-child {
      margin-bottom: 0;
    }
    
    .claim-step.problem {
      padding-bottom: 16px;
      border-bottom: 1px dashed #d1d5db;
      margin-bottom: 16px;
    }
    
    /* 8. HINT BOX STÄ°LLERÄ° */
    .hint-box {
      margin-top: 10px;
      padding: 10px 12px;
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      font-size: 12px;
      color: #4b5563;
      border-left: 3px solid #94a3b8;
      display: none;
    }
    
    .hint-box.show {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    /* Textarea focus durumunda hint gÃ¶ster */
    .cpr-section-card textarea:focus + .hint-box,
    .cpr-section-card textarea:focus ~ .hint-box {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-5px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* 9. FIELD TOOLS STÄ°LLERÄ° */
    .fieldTools {
      margin-top: 12px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    .fieldTools .btn {
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 12px;
      border: 1px solid #d1d5db;
      background: white;
      color: #4b5563;
    }
    
    .fieldTools .btn:hover {
      background: #f1f5f9;
      border-color: #94a3b8;
    }
    
    /* 10. Ä°KÄ° KOLON DÃœZENÄ° (Fayda & Recommendation) */
    .two {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
    }
    
    .two > div {
      margin-bottom: 0 !important;
    }
    
    /* 11. MOBÄ°L OPTÄ°MÄ°ZASYON */
    @media (max-width: 768px) {
      .cpr-section-card {
        padding: 14px 12px 10px 12px;
        margin-bottom: 16px;
        border-radius: 12px;
      }
      
      .cpr-section-card::before {
        left: 12px;
        font-size: 10px;
        padding: 3px 8px;
        top: -8px;
      }
      
      .cpr-section-card label {
        font-size: 15px;
        margin-bottom: 10px;
      }
      
      .cpr-section-card textarea {
        min-height: 75px;
        font-size: 15px;
        padding: 10px 40px 10px 10px;
      }
      
      .cpr-section-card .voice-btn {
        width: 32px;
        height: 32px;
        right: 8px;
        bottom: 8px;
        font-size: 14px;
      }
      
      .claim-step {
        margin-bottom: 14px;
      }
      
      .claim-step.problem {
        padding-bottom: 14px;
        margin-bottom: 14px;
      }
      
      .two {
        grid-template-columns: 1fr;
        gap: 16px;
        margin-top: 16px;
      }
      
      .hint-box {
        font-size: 13px;
      }
      
      .fieldTools {
        margin-top: 10px;
      }
    }
    
    /* =========================================== */
    /* ğŸ“Œ DÄ°ÄER CSS KODLARI (MEVCUT KORUNDU) */
    /* =========================================== */
    
    /* ğŸ“± FAZ 1: MOBÄ°L KLAVYE ARAÃ‡ Ã‡UBUÄU */
    .mobile-toolbar {
      display: flex !important;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      border-top: 1px solid var(--border);
      padding: 8px 12px calc(8px + env(safe-area-inset-bottom, 0px));
      z-index: 1000;
      box-shadow: 0 -2px 20px rgba(0,0,0,0.1);
      flex-wrap: nowrap;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      gap: 8px;
    }
    
    .mobile-toolbar button {
      flex: 0 0 auto;
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: var(--soft);
      font-size: 12px;
      white-space: nowrap;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      min-height: 36px;
    }
    
    .mobile-toolbar button.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    
    /* ğŸ“± FAZ 1: SESLÄ° GÄ°RÄ°Å BUTONLARI */
    .voice-btn.listening {
      background: #b3261e !important;
      color: white !important;
      border-color: #b3261e !important;
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(179, 38, 30, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(179, 38, 30, 0); }
      100% { box-shadow: 0 0 0 0 rgba(179, 38, 30, 0); }
    }
    
    /* ğŸ“± FAZ 4: SESLÄ° GÄ°RÄ°Å GELÄ°ÅTÄ°RMELERÄ° Ä°Ã‡Ä°N YENÄ° STÄ°LLER */
    .voice-indicator {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 2500;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 12px 20px;
      border-radius: 50px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
    }
    
    .voice-indicator .pulse {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #ef4444;
      animation: voicePulse 1.2s infinite;
    }
    
    @keyframes voicePulse {
      0% { transform: scale(0.8); opacity: 0.7; }
      50% { transform: scale(1.2); opacity: 1; }
      100% { transform: scale(0.8); opacity: 0.7; }
    }
    
    .voice-feedback {
      position: absolute;
      bottom: 60px;
      right: 10px;
      background: rgba(59, 130, 246, 0.9);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      z-index: 100;
      box-shadow: 0 2px 10px rgba(59, 130, 246, 0.3);
    }
    
    /* ğŸ“± FAZ 2: DRAFT KAYIT SÄ°STEMÄ° CSS */
    .draft-indicator {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      background: var(--soft);
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all 0.3s ease;
      position: fixed;
      bottom: 70px;
      right: 15px;
      z-index: 999;
    }
    
    .draft-indicator.saved {
      background: rgba(19, 115, 51, 0.1);
      border-color: rgba(19, 115, 51, 0.3);
      color: var(--ok);
    }
    
    .draft-indicator:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    /* ğŸ“± FAZ 3: BAÄLANTI DURUM GÃ–STERGESÄ° (Connectivity Manager) */
    .offline-status {
      position: fixed;
      top: 10px;
      right: 10px;
      background: var(--warn);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      z-index: 2000;
      display: none;
      align-items: center;
      gap: 6px;
      box-shadow: 0 2px 10px rgba(176, 96, 0, 0.3);
      transition: all 0.3s ease;
    }
    
    .offline-status.online {
      background: var(--ok);
      display: flex;
    }
    
    .offline-status.offline {
      background: var(--warn);
      display: flex;
    }
    
    .offline-status .icon {
      font-size: 14px;
    }
    
    /* ğŸ“± FAZ 2: MOBÄ°L BÄ°LDÄ°RÄ°M ALANI */
    #mobileNotificationArea {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 3000;
      width: 90%;
      max-width: 400px;
      pointer-events: none;
    }
    
    .mobile-notification {
      background: white;
      color: var(--text);
      padding: 12px 16px;
      border-radius: var(--radius);
      margin-bottom: 10px;
      box-shadow: var(--shadow);
      border-left: 4px solid var(--accent);
      display: flex;
      align-items: center;
      gap: 10px;
      animation: slideDown 0.3s ease;
      pointer-events: auto;
      font-size: 13px;
    }
    
    .mobile-notification.success {
      border-left-color: var(--ok);
      background: rgba(19, 115, 51, 0.05);
    }
    
    .mobile-notification.warning {
      border-left-color: var(--warn);
      background: rgba(176, 96, 0, 0.05);
    }
    
    .mobile-notification.error {
      border-left-color: var(--bad);
      background: rgba(179, 38, 30, 0.05);
    }
    
    .mobile-notification.info {
      border-left-color: var(--accent);
      background: rgba(11, 95, 255, 0.05);
    }
    
    .mobile-notification .icon {
      font-size: 18px;
      flex-shrink: 0;
    }
    
    .mobile-notification .close-btn {
      margin-left: auto;
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: var(--muted);
      padding: 0;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }
    
    .mobile-notification .close-btn:hover {
      background: rgba(0,0,0,0.05);
    }
    
    @keyframes slideDown {
      from { 
        opacity: 0; 
        transform: translateX(-50%) translateY(-20px); 
      }
      to { 
        opacity: 1; 
        transform: translateX(-50%) translateY(0); 
      }
    }
    
    /* ğŸ“‹ FAZ 5: PDF RAPOR BUTON STÄ°LÄ° */
    .pdf-generating {
      opacity: 0.7;
      cursor: wait !important;
    }
    
    .pdf-generating::after {
      content: '...';
      animation: pdfDots 1.5s infinite;
    }
    
    @keyframes pdfDots {
      0%, 20% { content: '.'; }
      40% { content: '..'; }
      60%, 100% { content: '...'; }
    }
    
    /* GENEL STÄ°LLER (MEVCUT TASARIM KORUNDU) */
    .container{
      max-width:960px;
      margin:0 auto 60px;
    }
    header{
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-bottom:16px;
    }
    h1{
      font-size:22px;
      letter-spacing:0.04em;
      text-transform:uppercase;
      margin:0;
      display:flex;
      align-items:center;
      gap:8px;
    }
    h1 span.icon{
      font-size:22px;
    }
    .sub{
      font-size:13px;
      color:var(--muted);
    }
    .tagline{
      margin-top:4px;
      font-size:12px;
      color:var(--muted);
    }
    .badgeRow{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:8px;
    }
    .pill{
      font-size:11px;
      padding:4px 8px;
      border-radius:999px;
      background:var(--soft);
      border:1px solid var(--border);
      display:inline-flex;
      align-items:center;
      gap:4px;
    }
    .pill span{
      font-size:14px;
    }
    main{
      display:flex;
      flex-direction:column;
      gap:16px;
    }
    .card{
      background:white;
      border-radius:var(--radius);
      border:1px solid var(--border);
      box-shadow:var(--shadow);
      padding:14px 14px 16px;
    }
    .cardHeader{
      display:flex;
      justify-content:space-between;
      gap:8px;
      margin-bottom:10px;
      align-items:flex-start;
    }
    .cardTitle{
      font-weight:600;
      font-size:14px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .cardTitle span.icon{
      font-size:16px;
    }
    .cardMeta{
      font-size:11px;
      color:var(--muted);
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:4px;
    }
    .miniLabel{
      font-size:11px;
    }
    .counters{
      display:flex;
      gap:4px;
    }
    .counter{
      padding:3px 6px;
      border-radius:999px;
      background:var(--soft);
      border:1px solid var(--border);
      font-size:11px;
    }
    .counter span{
      font-weight:600;
    }
    .sectionTitle{
      font-size:13px;
      font-weight:600;
      margin-bottom:6px;
      display:flex;
      align-items:center;
      gap:6px;
    }
    .sectionTitle span.icon{font-size:14px}
    .small{
      font-size:12px;
      color:var(--muted);
    }
    label{
      font-size:12px;
      font-weight:500;
      margin-bottom:4px;
      display:block;
    }
    textarea{
      width:100%;
      min-height:90px;
      padding:10px 38px 10px 10px;
      border-radius:12px;
      border:1px solid var(--border);
      resize:vertical;
      font-family:var(--sans);
      line-height:1.4;
      font-size:13px;
      transition:border .15s, box-shadow .15s, background .15s;
      background:white;
    }
    textarea:focus{
      outline:none;
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(11,95,255,0.1);
      background:#f8f9ff;
    }
    textarea[disabled]{
      background:#f5f5f5;
      color:#999;
      cursor:not-allowed;
    }
    input[type="text"]{
      width:100%;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid var(--border);
      font-size:13px;
      font-family:var(--sans);
    }
    input[type="text"]:focus{
      outline:none;
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(11,95,255,0.1);
    }
    select{
      width:100%;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid var(--border);
      font-size:13px;
      font-family:var(--sans);
      background:white;
    }
    select:focus{
      outline:none;
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(11,95,255,0.1);
    }
    .two{
      display:grid;
      grid-template-columns:1.2fr 1.1fr;
      gap:10px;
      margin-top:6px;
    }
    .two > div{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .hint{
      font-size:11px;
      color:var(--muted);
      margin:0 0 4px;
    }
    .hint b{
      color:#000;
    }
    .hint-box{
      margin-top:4px;
      font-size:11px;
      color:var(--muted);
      border-radius:8px;
      padding:6px 8px;
      background:#f9fafb;
      border:1px dashed #d0d7de;
      display:none;
    }
    .hint-box.show{
      display:block;
    }
    .btnRow{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:8px;
    }
    .btn{
      border-radius:999px;
      border:none;
      padding:6px 10px;
      font-size:12px;
      display:inline-flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
      background:var(--accent);
      color:white;
      box-shadow:0 2px 8px rgba(11,95,255,0.28);
      min-height:32px;
    }
    .btn.small{
      padding:4px 8px;
      font-size:11px;
      min-height:26px;
    }
    .btn.ghost{
      background:white;
      color:#111;
      border:1px solid var(--border);
      box-shadow:none;
    }
    .btn.ghost:hover{
      background:#f3f4ff;
      border-color:#c7d2fe;
    }
    .btn[disabled],
    .btn:disabled{
      opacity:0.5;
      cursor:not-allowed;
      box-shadow:none;
    }
    .btn.primary{
      background:#0b5fff;
      color:white;
      border:1px solid #0b5fff;
    }
    .btn.primary:hover{
      background:#0847c0;
      border-color:#0847c0;
    }
    .btn.success{
      background:#137333;
      border-color:#137333;
    }
    .btn.success:hover{
      background:#0f5a28;
    }
    .btn.iconOnly{
      padding:6px;
      width:30px;
      justify-content:center;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      border-radius:999px;
      font-size:11px;
      padding:3px 8px;
      background:var(--soft);
      border:1px solid var(--border);
      gap:4px;
    }
    .badge.ok{
      background:#e8f5e9;
      border-color:#c8e6c9;
      color:#1b5e20;
    }
    .badge.warn{
      background:#fff8e1;
      border-color:#ffe0b2;
      color:#e65100;
    }
    .badge.bad{
      background:#ffebee;
      border-color:#ffcdd2;
      color:#b71c1c;
    }
    .badge span.icon{
      font-size:13px;
    }
    .presetRow{
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-bottom:8px;
    }
    .presetRowInner{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
    }
    .presetCard{
      border-radius:999px;
      border:1px solid var(--border);
      padding:4px 10px;
      font-size:11px;
      background:#f9fafb;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .presetCard span.icon{
      font-size:14px;
    }
    .activePreset{
      font-size:11px;
      color:var(--muted);
    }
    .kwWrap{
      display:flex;
      gap:6px;
      align-items:flex-start;
      margin-top:4px;
    }
    .kwWrap textarea{
      min-height:70px;
    }
    .statusBar{
      margin-top:8px;
      padding:6px 8px;
      border-radius:10px;
      background:#f9fafb;
      border:1px dashed #d0d7de;
      font-size:11px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
    }
    .statusLeft{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      align-items:center;
    }
    .statusRight{
      font-family:var(--mono);
      font-size:11px;
      color:var(--muted);
    }
    .statusRight span{
      font-weight:600;
      color:#000;
    }
    .miniTag{
      display:inline-flex;
      align-items:center;
      gap:4px;
      font-size:11px;
      padding:2px 6px;
      border-radius:999px;
      background:#f3f4ff;
      border:1px solid #c7d2fe;
    }
    .miniTag span.icon{
      font-size:12px;
    }
    .lock{
      font-size:11px;
      padding:2px 6px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#f9fafb;
    }
    .lock.badge-locked{
      background:#ffebee;
      border-color:#ffcdd2;
      color:#b71c1c;
    }
    .lock.badge-open{
      background:#e8f5e9;
      border-color:#c8e6c9;
      color:#1b5e20;
    }
    .lock.badge-wait{
      background:#fff8e1;
      border-color:#ffe0b2;
      color:#e65100;
    }
    .cpanel{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:8px;
    }
    .cpanel .badge{
      cursor:default;
    }
    .cpanel .badge strong{
      font-weight:600;
    }
    .sumRow{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .sumRow textarea{
      min-height:120px;
    }
    .sumRow .small{
      margin-top:2px;
    }
    .acc{
      border-radius:var(--radius);
      border:1px solid rgba(0,0,0,0.05);
      background:#fdfdfd;
      margin:0 0 6px;
      padding:0;
    }
    .acc[open]{
      background:#f8f9ff;
      border-color:#c7d2fe;
      box-shadow:0 8px 18px rgba(15,23,42,0.08);
    }
    .acc summary{
      list-style:none;
      padding:10px 12px;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .acc summary::-webkit-details-marker{display:none}
    .accTitle{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .accTitle b{
      font-size:13px;
    }
    .accTitle span{
      font-size:11px;
      color:var(--muted);
    }
    .accMeta{
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:4px;
      font-size:11px;
      color:var(--muted);
    }
    .accMeta .tag{
      padding:2px 6px;
      border-radius:999px;
      background:#f3f4ff;
      border:1px solid #c7d2fe;
      font-size:11px;
    }
    .accBody{
      border-top:1px solid rgba(0,0,0,0.04);
      padding:8px 12px 10px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .acc[open] summary{
      border-bottom:1px solid rgba(0,0,0,0.04);
      background:linear-gradient(to right,#eef2ff,#f9fafb);
    }
    .acc summary .arrow{
      font-size:16px;
      transition:transform 0.2s;
    }
    .acc[open] summary .arrow{
      transform:rotate(90deg);
    }
    .fieldRow{
      display:flex;
      flex-direction:column;
      gap:4px;
      margin-top:4px;
    }
    .fieldTools{
      display:flex;
      flex-wrap:wrap;
      gap:4px;
      justify-content:flex-end;
      margin-top:4px;
    }
    .fieldTools .btn{
      font-size:10px;
      padding:3px 7px;
      min-height:0;
    }
    .fieldTools .btn span.icon{
      font-size:12px;
    }
    .fieldGroupTitle{
      font-size:12px;
      font-weight:600;
      margin-top:2px;
    }
    .kpiRow{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:4px;
      font-size:11px;
      color:var(--muted);
    }
    .kpiRow span strong{
      color:#000;
    }
    .styleGrid{
      display:flex;
      flex-direction:column;
      gap:16px;
      margin-top:6px;
    }
    .styleCard{
      border-radius:12px;
      border:1px solid var(--border);
      background:#fdfdfd;
      padding:8px 10px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .styleHeader{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
    }
    .styleTitle{
      font-size:12px;
      font-weight:600;
    }
    .styleBadge{
      font-size:11px;
      padding:2px 6px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#f9fafb;
      display:inline-flex;
      align-items:center;
      gap:4px;
    }
    .styleBadge span.icon{font-size:12px}
    .styleBody{
      font-size:11px;
      color:var(--muted);
    }
    .styleBody ul{
      margin:4px 0 0;
      padding-left:16px;
    }
    .styleBody li{
      margin-bottom:2px;
    }
    .styleFooter{
      margin-top:4px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
      font-size:11px;
    }
    .styleFooter .badge{
      font-size:10px;
    }
    .styleFooter .btn{
      font-size:10px;
      padding:3px 7px;
    }
    .style-badge{
      display:inline-flex;
      align-items:center;
      gap:4px;
      font-size:11px;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#f3f4ff;
      margin-bottom:4px;
    }
    .style-badge.explorer{
      background:#e0f2fe;
      border-color:#bae6fd;
    }
    .style-badge.reflector{
      background:#f3e8ff;
      border-color:#e9d5ff;
    }
    .style-badge.theorist{
      background:#eef2ff;
      border-color:#e0e7ff;
    }
    .style-badge.pragmatist{
      background:#ecfdf3;
      border-color:#bbf7d0;
    }
    .style-badge span.icon{
      font-size:13px;
    }
    .styled-cpr-area{
      min-height:110px;
    }
    .footerNote{
      font-size:11px;
      color:var(--muted);
      margin:0;
      margin-top:6px;
    }
    .footerNote b{
      color:#000;
    }
    .highlight{
      background:yellow;
    }
    .autoScore{
      font-family:var(--mono);
      font-size:11px;
      padding:3px 6px;
      border-radius:999px;
      background:#f3f4ff;
      border:1px solid #c7d2fe;
    }
    .badge.muted{
      background:#f3f4ff;
      border-color:#e5e7eb;
      color:#4b5563;
    }
    .badge.muted span.icon{
      color:#9ca3af;
    }
    .notice{
      margin-top:4px;
      font-size:11px;
      color:var(--muted);
    }
    .notice b{
      color:#000;
    }
    .badge.lite{
      background:#f9fafb;
      border-color:#e5e7eb;
    }
    .badge.lite strong{
      font-weight:600;
    }
    .styleFeedback{
      font-size:11px;
      color:#4b5563;
      background:#f9fafb;
      border-radius:10px;
      border:1px dashed #d1d5db;
      padding:6px 8px;
      margin-top:4px;
    }
    .styleFeedback b{
      color:#111827;
    }
    .smallNote{
      font-size:10px;
      color:#9ca3af;
      margin-top:2px;
    }
    .badge.soft{
      background:#f9fafb;
      border-color:#e5e7eb;
    }
    .badge.soft span.icon{
      color:#9ca3af;
    }
    .badge.soft strong{
      color:#111827;
    }
    .computedScore{
      font-size:11px;
      color:#111827;
      background:#eff6ff;
      border-radius:999px;
      padding:2px 6px;
      border:1px solid #bfdbfe;
    }
    .computedScore span{
      font-weight:600;
    }
    .small-badge{
      font-size:10px;
      padding:2px 6px;
      border-radius:999px;
      background:#f3f4ff;
      border:1px solid #e5e7eb;
      display:inline-flex;
      align-items:center;
      gap:4px;
    }
    .small-badge span.icon{
      font-size:11px;
    }
    .metaRow{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:4px;
      font-size:11px;
      color:#6b7280;
    }
    .metaRow span strong{
      color:#111827;
    }
    .pill.primary{
      background:#eff6ff;
      border-color:#bfdbfe;
      color:#1d4ed8;
    }
    .pill.primary span.icon{
      color:#3b82f6;
    }
    .pill.soft{
      background:#f9fafb;
      border-color:#e5e7eb;
      color:#4b5563;
    }
    .pill.soft span.icon{
      color:#9ca3af;
    }
    .pill.ok{
      background:#ecfdf3;
      border-color:#bbf7d0;
      color:#166534;
    }
    .pill.ok span.icon{
      color:#22c55e;
    }
    .pill.warn{
      background:#fffbeb;
      border-color:#fed7aa;
      color:#92400e;
    }
    .pill.warn span.icon{
      color:#f97316;
    }
    .pill.bad{
      background:#fef2f2;
      border-color:#fecaca;
      color:#b91c1c;
    }
    .pill.bad span.icon{
      color:#ef4444;
    }
    .lock span.icon{
      font-size:12px;
    }
    .mobileOnly{
      display:none;
    }
    @media (max-width:768px){
      .mobileOnly{
        display:inline-flex;
      }
    }
    .kwAdd{
      white-space:nowrap;
    }
    .listening-indicator {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      color: #111827;
      background: #eff6ff;
      border-radius: 999px;
      padding: 2px 8px;
      border: 1px solid #bfdbfe;
      margin-left: 6px;
    }
    
    .listening-indicator .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      animation: pulse-dot 1.2s infinite;
    }
    
    @keyframes pulse-dot {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.4); opacity: 0.7; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    /* âœ… CHIP PICKER (MOBÄ°L DOSTU Ã‡OKLU SEÃ‡Ä°M) */
    .chipDetails{ margin-top:4px; }
    .chipDetails summary::-webkit-details-marker{ display:none; }
    .chipTrigger{
      width:100%;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid var(--border);
      background:white;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      cursor:pointer;
      user-select:none;
    }
    .chipTrigger:focus{ outline:none; border-color:var(--accent); box-shadow:0 0 0 1px rgba(11,95,255,0.1); }
    .chipTriggerText{ font-size:13px; color:#111; }
    .chipPanel{ padding:10px 2px 4px; }
    .chipGrid{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .chipOption{
      border:1px solid var(--border);
      background:var(--soft);
      border-radius:999px;
      padding:8px 10px;
      font-size:12px;
      cursor:pointer;
      line-height:1.1;
      text-align:left;
      transition:background .15s, border-color .15s, transform .05s;
    }
    .chipOption:active{ transform:scale(0.98); }
    .chipOption.active{
      background:var(--accent);
      border-color:var(--accent);
      color:white;
    }
    .chipActions{
      display:flex;
      justify-content:flex-end;
      gap:6px;
      margin-top:10px;
      flex-wrap:wrap;
    }
    .chipSelected{
      margin-top:10px;
      padding-top:10px;
      border-top:1px dashed #d0d7de;
    }
    .pillWrap{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:6px;
    }
    .pillRem{
      cursor:pointer;
      border:none;
    }
    .pillRem .x{
      font-weight:700;
      opacity:0.8;
      margin-left:6px;
    }
    @media (max-width:768px){
      .chipDetails[open] .chipPanel{
        position:fixed;
        left:0;
        right:0;
        bottom:0;
        z-index:1200;
        background:white;
        border-top:1px solid var(--border);
        border-radius:18px 18px 0 0;
        box-shadow:0 -12px 30px rgba(0,0,0,0.12);
        padding:12px 12px calc(12px + env(safe-area-inset-bottom, 0px));
        max-height:70vh;
        overflow:auto;
        -webkit-overflow-scrolling:touch;
      }
    }

    /* --- ÃœRÃœN ODAK & HAZIRLIK (Chip / Pill SeÃ§im) --- */
    .pill.clickable{cursor:pointer; user-select:none;}
    .pill.clickable:hover{background:#eff6ff; border-color:#bfdbfe;}
    .pill.clickable.active{background:#eff6ff; border-color:#bfdbfe; color:#1d4ed8;}
    .pill.clickable.selected{background:#ecfdf3; border-color:#bbf7d0; color:#166534;}
    .pill.clickable.selected:hover{background:#dcfce7; border-color:#86efac;}
    .pill.removable{gap:6px;}
    .pill .x{font-weight:700; opacity:.7;}
    .pill .x:hover{opacity:1;}
  
    /* Fayda seÃ§im limiti (pill) */
    .pill.disabled{opacity:0.45;}

    /* Claim â€“ Problem & Etki gÃ¶rsel baÄŸlayÄ±cÄ± */
    .claim-group{
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px;
      background:#fafbff;
      display:flex;
      flex-direction:column;
      gap:14px;
      position:relative;
    }
    .claim-step{
      position:relative;
      padding-left:34px;
    }
    .claim-step::before{
      content: attr(data-step);
      position:absolute;
      left:0;
      top:0;
      width:24px;
      height:24px;
      border-radius:50%;
      background:var(--accent);
      color:white;
      font-size:12px;
      font-weight:600;
      display:flex;
      align-items:center;
      justify-content:center;
    }

</style>
</head>
<body>
  <!-- ğŸ“± FAZ 3: GELÄ°ÅTÄ°RÄ°LMÄ°Å OFFLINE DURUM GÃ–STERGESÄ° -->
  <div class="offline-status" id="offlineStatus">
    <span class="icon">ğŸ“¡</span>
    <span id="connectivityText">Ã‡evrimdÄ±ÅŸÄ±</span>
  </div>

  <!-- ğŸ“± FAZ 1: MOBÄ°L TOOLBAR -->
  <div class="mobile-toolbar" id="mobileToolbar">
    <button data-action="claim" title="Claim ÅŸablonu">ğŸ“ Claim</button>
    <button data-action="feature" title="Feature ÅŸablonu">âš™ï¸ Feature</button>
    <button data-action="advantage" title="Advantage ÅŸablonu">ğŸš€ Advantage</button>
    <button data-action="benefit" title="Benefit ÅŸablonu">âœ… Benefit</button>
    <button data-action="recommendation" title="Recommendation ÅŸablonu">ğŸ’¡ Recommendation</button>
    <button data-action="copy" title="Kopyala">ğŸ“‹ Kopyala</button>
    <button data-action="paste" title="YapÄ±ÅŸtÄ±r">ğŸ“ YapÄ±ÅŸtÄ±r</button>
    <button data-action="clear" title="Temizle">ğŸ—‘ï¸ Temizle</button>
  </div>

  <!-- ğŸ“± FAZ 2: DRAFT KAYIT GÃ–STERGESÄ° -->
  <div class="draft-indicator" id="draftIndicator" title="Draft durumu">
    ğŸ’¾ Draft
  </div>

  <div class="container">
    <header>
      <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
        <div>
          <h1>
            <span class="icon">ğŸ§ </span>
            FAST CPR KOÃ‡U
          </h1>
          <div class="sub">Claim â†’ Proposition â†’ Recommendation akÄ±ÅŸÄ±na adÄ±m adÄ±m koÃ§luk eden, mobil uyumlu CPR yazÄ±m aracÄ±</div>
        </div>
        <!-- ğŸ“„ YENÄ° TÃœM RAPOR PDF BUTONU -->
        <div class="pill" style="cursor: pointer; background: #3b82f6; color: white; margin-left: auto; transition: all 0.2s; padding: 8px 12px;" id="fullReportPDF" title="TÃ¼m Ã§alÄ±ÅŸmayÄ± PDF olarak indir">
          <span class="icon">ğŸ“„</span>
          <span>PDF'e Aktar</span>
        </div>
      </div>
      <div class="badgeRow">
        <div class="pill soft">
          <span class="icon">ğŸ§©</span>
          <span>FAST = CCS + ROSS + A-ROSS</span>
        </div>
        <div class="pill ok">
          <span class="icon">âœ…</span>
          <span>Temel CPR â‰¥ 13 ise stil CPR'larÄ± aktifleÅŸir</span>
        </div>
      </div>
    </header>
    
    <main>
      <!-- 1. ZÄ°YARET Ã–NCESÄ° HAZIRLIK KARTI (AKORDEON - AÃ‡IK) -->
      <details class="acc" data-acc="preparation" id="acc_preparation" open>
        <summary>
          <div class="accTitle">
            <b><span class="arrow">â–¶</span> Ziyaret Ã–ncesi HazÄ±rlÄ±k</b>
            <span>Bu alanda kaydettiÄŸiniz bilgileri zihinsel hazÄ±rlÄ±k iÃ§indir. Zorunlu deÄŸildir</span>
          </div>
          <div class="accMeta">
            <span class="tag">ğŸ¯ HazÄ±rlÄ±k</span>
          </div>
        </summary>
        
        <div class="accBody">
          <div class="fieldRow">
            <label for="promoContext">Doktor / EczacÄ±nÄ±n Sosyal Stili <span class="small">(LÃ¼tfen <a href="https://iskendereser.github.io/S4Survey/" target="_blank" rel="noopener">FAST S4 Survey</a> kullanÄ±nÄ±z)</span></label>
            <input id="promoContext" type="text" placeholder="Ã–rn: Driving / Analytical / Expressive / Amiable (veya kendi notunuz)" />
          </div>

          <div class="fieldRow">
            <label for="flexBehaviors">Uyumlu iletiÅŸim iÃ§in esneyeceÄŸiniz davranÄ±ÅŸlarÄ± seÃ§iniz <span class="small">(<a href="https://iskendereser.github.io/S4Survey/" target="_blank" rel="noopener">LÃ¼tfen FAST Compare</a> kullanÄ±nÄ±z)</span></label>

            <details class="chipDetails" id="flexPicker">
              <summary class="chipTrigger" role="button" aria-label="DavranÄ±ÅŸ seÃ§imi">
                <span class="chipTriggerText" id="flexTriggerText">DavranÄ±ÅŸ seÃ§in</span>
                <span class="small-badge" id="flexCount"><span class="icon">âœ…</span><span>0/16</span></span>
              </summary>
              <div class="chipPanel">
                <div class="chipGrid" id="flexChipGrid">
                    <button type="button" class="chipOption" data-value="KonuÅŸma hÄ±zÄ±nÄ± artÄ±rma">KonuÅŸma hÄ±zÄ±nÄ± artÄ±rma</button>
                    <button type="button" class="chipOption" data-value="KonuÅŸma hÄ±zÄ±nÄ± yavaÅŸlatma">KonuÅŸma hÄ±zÄ±nÄ± yavaÅŸlatma</button>
                    <button type="button" class="chipOption" data-value="Sesin hacmini artÄ±rma">Sesin hacmini artÄ±rma</button>
                    <button type="button" class="chipOption" data-value="Sesin hacmini azaltma">Sesin hacmini azaltma</button>
                    <button type="button" class="chipOption" data-value="Mimikleri artÄ±rma">Mimikleri artÄ±rma</button>
                    <button type="button" class="chipOption" data-value="Mimikleri azaltma">Mimikleri azaltma</button>
                    <button type="button" class="chipOption" data-value="GÃ¶z temasÄ±nÄ± artÄ±rma">GÃ¶z temasÄ±nÄ± artÄ±rma</button>
                    <button type="button" class="chipOption" data-value="GÃ¶z temasÄ±nÄ± azaltma">GÃ¶z temasÄ±nÄ± azaltma</button>
                    <button type="button" class="chipOption" data-value="Ellerin kullanÄ±mÄ±nÄ± artÄ±rma">Ellerin kullanÄ±mÄ±nÄ± artÄ±rma</button>
                    <button type="button" class="chipOption" data-value="Ellerin kullanÄ±mÄ±nÄ± azaltma">Ellerin kullanÄ±mÄ±nÄ± azaltma</button>
                    <button type="button" class="chipOption" data-value="Atak duruÅŸ sergileme">Atak duruÅŸ sergileme</button>
                    <button type="button" class="chipOption" data-value="Ã‡ekinik duruÅŸ sergileme">Ã‡ekinik duruÅŸ sergileme</button>
                    <button type="button" class="chipOption" data-value="GerÃ§ekleri konuÅŸma">GerÃ§ekleri konuÅŸma</button>
                    <button type="button" class="chipOption" data-value="Hikayemsi konuÅŸma">Hikayemsi konuÅŸma</button>
                    <button type="button" class="chipOption" data-value="Kelime sayÄ±sÄ±nÄ± artÄ±rma">Kelime sayÄ±sÄ±nÄ± artÄ±rma</button>
                    <button type="button" class="chipOption" data-value="Kelime sayÄ±sÄ±nÄ± azaltma">Kelime sayÄ±sÄ±nÄ± azaltma</button>
                </div>

                <div class="chipActions">
                  <button type="button" class="btn ghost small" id="flexClear">Temizle</button>
                  <button type="button" class="btn primary small" id="flexDone">Bitti</button>
                </div>

                <div class="chipSelected">
                  <div class="sectionTitle"><span class="icon">ğŸ·ï¸</span><span>SeÃ§ilenler</span></div>
                  <div class="pillWrap" id="flexPills" aria-live="polite"></div>
                  <input type="hidden" id="flexBehaviors" value="" />
                </div>
                <div class="smallNote">Ä°pucu: Bir seÃ§eneÄŸe tekrar dokunarak seÃ§imi kaldÄ±rabilirsiniz.</div>
              </div>
            </details>

            <div class="small">Birden fazla seÃ§im yapabilirsiniz. SeÃ§im sÄ±nÄ±rÄ± yoktur.</div>
          </div>

          <div class="fieldRow">
            <label for="learningStyle">Ã–ÄŸrenme stilini belirleyiniz <span class="small">(LÃ¼tfen <a href="https://iskendereser.github.io/LSA/" target="_blank" rel="noopener">FAST LSA</a> kullanÄ±nÄ±z)</span></label>
            <input id="learningStyle" type="text" placeholder="Ã–rn: Aktivist / ReflektÃ¶r / Teorist / Pragmatist" />
          </div>

          <div class="fieldRow">
            <label for="promoGoal">SMART CPR hedefinizi yazÄ±n</label>
            <textarea id="promoGoal" class="autoGrow" placeholder="Ã–rn: Bu ziyarette X konuda Y Ã¶lÃ§Ã¼lebilir hedef..." rows="2"></textarea>
          </div>
        </div>
      </details>
      
      <!-- 2. ÃœRÃœN ODAK & HAZIRLIK KARTI (AKORDEON - KAPALI) -->
      <details class="acc" data-acc="productprep" id="acc_productprep">
        <summary>
          <div class="accTitle">
            <b><span class="arrow">â–¶</span> ÃœrÃ¼n Odak & HazÄ±rlÄ±k</b>
            <span>ÃœrÃ¼n â†’ Rakip â†’ ÃœstÃ¼n YÃ¶n â†’ SunacaÄŸÄ±nÄ±z Fayda. Bu kart, aÅŸaÄŸÄ±daki CPR yazÄ±mÄ±nda "fener" gibi referans olsun diye vardÄ±r.</span>
          </div>
          <div class="accMeta">
            <span class="tag">ğŸ§­ HazÄ±rlÄ±k</span>
            <div class="counters">
              <div class="counter">
                ğŸ§­ <span>HazÄ±rlÄ±k</span>
              </div>
              <div class="counter">
                ğŸ§  <span>HatÄ±rlatÄ±cÄ±</span>
              </div>
            </div>
          </div>
        </summary>
        
        <div class="accBody">
          <div class="presetRow">
            <div class="presetRowInner">
              <div class="presetCard">
                <span class="icon">ğŸ’Š</span>
                <span>ÃœrÃ¼n seÃ§ / ekle</span>
              </div>
              <div class="presetCard">
                <span class="icon">ğŸ</span>
                <span>Rakip seÃ§ / ekle</span>
              </div>
              <div class="presetCard">
                <span class="icon">â­</span>
                <span>ÃœstÃ¼n yÃ¶n + fayda seÃ§</span>
              </div>
            </div>
            <div class="activePreset" id="activeProductLabel" aria-live="polite">SeÃ§ilen Ã¼rÃ¼n: â€”</div>
          </div>

          <!-- 1) ÃœRÃœN -->
          <div class="fieldRow">
            <label for="productNameInput">ÃœrÃ¼n (ilk kullanÄ±mda elle yazÄ±n)</label>
            <div class="kwWrap">
              <input id="productNameInput" type="text" placeholder="Ã–rn: Zoramisin" />
              <button class="btn ghost small kwAdd" id="addProductBtn" type="button">Ekle</button>
            </div>
            <div class="notice">Ä°pucu: ÃœrÃ¼n adlarÄ± otomatik biÃ§imlendirilir (ilk harf bÃ¼yÃ¼k). Daha sonra pill Ã¼zerinden tek dokunuÅŸla seÃ§ebilirsiniz.</div>
            <div class="badgeRow" id="productPills" style="margin-top:8px;"></div>
          </div>

          <!-- 2) RAKÄ°P -->
          <div class="fieldRow" style="margin-top:10px;">
            <label for="competitorNameInput">Rakip (elle yazÄ±lÄ±r, kayÄ±t olur)</label>
            <div class="kwWrap">
              <input id="competitorNameInput" type="text" placeholder="Ã–rn: Rakip ÃœrÃ¼n" />
              <button class="btn ghost small kwAdd" id="addCompetitorBtn" type="button">Ekle</button>
            </div>
            <div class="activePreset" id="activeCompetitorLabel" aria-live="polite" style="margin-top:6px;">SeÃ§ilen rakip: â€”</div>
            <div class="badgeRow" id="competitorPills" style="margin-top:8px;"></div>
          </div>

          <!-- 3) ÃœSTÃœN YÃ–N -->
          <div class="fieldRow" style="margin-top:10px;">
            <label for="superiorityInput">ÃœstÃ¼n YÃ¶nÃ¼nÃ¼z</label>
            <div class="hint">Ä°stersen aÅŸaÄŸÄ±daki hÄ±zlÄ± seÃ§eneklere dokun, istersen elle yaz.</div>
            <div class="badgeRow" id="superiorityPills"></div>
            <input id="superiorityInput" type="text" placeholder="Ã–rn: GÃ¼nde tek doz ile hasta uyumunu artÄ±rÄ±r" />
          </div>

          <!-- 4) SUNULACAK FAYDA -->
          <div class="fieldRow" style="margin-top:10px;">
            <label>SunacaÄŸÄ±nÄ±z Fayda (en fazla 2 seÃ§im)</label>
            <div class="hint">Kriterlere dokundukÃ§a seÃ§ilir/kaldÄ±rÄ±lÄ±r. SeÃ§tikleriniz altta pill olarak gÃ¶rÃ¼nÃ¼r.</div>
            <div class="kwWrap" style="margin-top:6px;">
              <input id="benefitCustomInput" type="text" placeholder="Kendi faydanÄ±zÄ± yazÄ±n (opsiyonel)" />
              <button class="btn ghost small kwAdd" id="addBenefitBtn" type="button">Ekle</button>
            </div>
            <div class="smallNote">EklediÄŸiniz faydalar kaydedilir ve tekrar kullanÄ±mda seÃ§enek olarak gÃ¶rÃ¼nÃ¼r.</div>
            <div class="badgeRow" id="benefitOptions"></div>
            <div class="badgeRow" id="benefitSelected" style="margin-top:8px;"></div>
            <div class="kwWrap" style="margin-top:8px;">
              <textarea id="benefitTextArea" placeholder="SeÃ§tiÄŸiniz faydalar burada gÃ¶rÃ¼nÃ¼r (2 seÃ§im)"></textarea>
            </div>
            <div class="fieldTools" style="justify-content:flex-start;">
              <button class="btn ghost small" id="clearBenefitsBtn" type="button">SeÃ§imleri Temizle</button>
            </div>
          </div>
        </div>
      </details>
      
      <!-- 3. TEMEL CPR KARTI (AKORDEON - KAPALI) -->
      <details class="acc" data-acc="base" id="acc_base">
        <summary>
          <div class="accTitle">
            <b><span class="arrow">â–¶</span> 1) Temel CPR (Stilsiz)</b>
            <span>Sadece CPR yapÄ±sÄ± kontrol edilir. CPR â‰¥ 13 olunca stiller aktifleÅŸir.</span>
          </div>
          <div class="accMeta">
            <span class="tag" id="mini_base">CPR: â€”</span>
            <!-- ğŸ“± FAZ 2: DRAFT BUTONU EKLENDÄ° -->
            <button class="btn ghost small" id="btnSaveDraft" style="font-size:10px; padding:3px 8px;">ğŸ’¾ Kaydet</button>
          </div>
        </summary>
        <div class="accBody">
          <p class="hint">Bu bÃ¶lÃ¼mde <b>stil deÄŸerlendirmesi yapÄ±lmaz</b>. </p>
          
          <!-- CLAIM ALANI -->
          <div class="cpr-section-card" data-section="claim">
            <div class="claim-group">
              <div class="claim-step problem">
                <label for="base_claim_problem">Problemi TanÄ±mlayÄ±n:</label>
                <div class="textarea-wrapper">
                  <textarea id="base_claim_problem" placeholder="Klinik problemi yazÄ±n..."></textarea>
                  <button class="voice-btn" data-target="base_claim_problem" title="Sesli giriÅŸ">ğŸ¤</button>
                </div>
              </div>
              
              <div class="claim-step">
                <label for="base_claim_effect">Etkisini TanÄ±mlayÄ±n:</label>
                <div class="textarea-wrapper">
                  <textarea id="base_claim_effect" placeholder="Bu problemin hasta, hekim veya sÃ¼reÃ§ Ã¼zerindeki etkisini yazÄ±n..."></textarea>
                  <button class="voice-btn" data-target="base_claim_effect" title="Sesli giriÅŸ">ğŸ¤</button>
                </div>
              </div>
            </div>
            <div class="fieldTools">
              <button class="btn ghost small" id="clear_base_claim_problem">Temizle</button>
            </div>
          </div>
          
          <!-- PROPOSITION - Ã–ZELLÄ°K -->
          <div class="cpr-section-card" data-section="feature">
            <label for="base_feat">ÃœrÃ¼n adÄ± ve problemi Ã§Ã¶zen temel Ã¶zelliÄŸi yazÄ±n</label>
            <div class="textarea-wrapper">
              <textarea id="base_feat" placeholder="Ã–rn: ÃœrÃ¼n X, gÃ¼nde tek doz kullanÄ±m ile hasta uyumunu artÄ±rÄ±r"></textarea>
              <button class="voice-btn" data-target="base_feat" title="Sesli giriÅŸ">ğŸ¤</button>
            </div>
            <div class="hint-box" id="hint_base_feat">ÃœrÃ¼nÃ¼nÃ¼zÃ¼n rakiplerden farklÄ±, hastaya saÄŸladÄ±ÄŸÄ± temel Ã§Ã¶zÃ¼mÃ¼ tanÄ±mlayÄ±n.</div>
            <div class="fieldTools">
              <button class="btn ghost small" id="clear_base_feat">Temizle</button>
            </div>
          </div>
          
          <!-- PROPOSITION - AVANTAJ -->
          <div class="cpr-section-card" data-section="advantage">
            <label for="base_adv">Rakiplere gÃ¶re Ã¼stÃ¼nlÃ¼ÄŸÃ¼, ticari isim kullanmadan yazÄ±n</label>
            <div class="textarea-wrapper">
              <textarea id="base_adv" placeholder="Ã–rn: Bu sayede benzer etki gÃ¶sterenlere gÃ¶re gÃ¼nde tek doz kullanÄ±lÄ±r"></textarea>
              <button class="voice-btn" data-target="base_adv" title="Sesli giriÅŸ">ğŸ¤</button>
            </div>
            <div class="hint-box" id="hint_base_adv">Rakip Ã¼rÃ¼nlerle karÅŸÄ±laÅŸtÄ±rma yapÄ±n, ancak rakip ismi kullanmayÄ±n.</div>
            <div class="fieldTools">
              <button class="btn ghost small" id="clear_base_adv">Temizle</button>
            </div>
          </div>
          
          <!-- PROPOSITION - FAYDA ve RECOMMENDATION (Ä°ki Kolon) -->
          <div class="two">
            <div class="cpr-section-card" data-section="benefit">
              <label for="base_ben">AvantajÄ±n hastanÄ±n sorununu nasÄ±l rahatlattÄ±ÄŸÄ±nÄ± yazÄ±n</label>
              <div class="textarea-wrapper">
                <textarea id="base_ben" placeholder="Ã–rn: Tedavilerini aksatmadan devam ederler, iÅŸlerini yapmaktan geri kalmazlar"></textarea>
                <button class="voice-btn" data-target="base_ben" title="Sesli giriÅŸ">ğŸ¤</button>
              </div>
              <div class="hint-box" id="hint_base_ben">HastanÄ±n gÃ¼nlÃ¼k yaÅŸamÄ±nda nasÄ±l bir iyileÅŸme/rahatlama saÄŸladÄ±ÄŸÄ±nÄ± aÃ§Ä±klayÄ±n.</div>
              <div class="fieldTools">
                <button class="btn ghost small" id="clear_base_ben">Temizle</button>
              </div>
            </div>
            
            <div class="cpr-section-card" data-section="recommendation">
              <label for="base_rec">Problemle iliÅŸkilendirilmiÅŸ reÃ§ete Ã¶neri cÃ¼mlenizi yazÄ±n</label>
              <div class="textarea-wrapper">
                <textarea id="base_rec" placeholder="Ã–rn: Bu tÃ¼r ataklarda, gÃ¼nde tek doz kullanÄ±lan X ile tedaviye bir an Ã¶nce baÅŸlamayÄ± tercih eder misiniz?"></textarea>
                <button class="voice-btn" data-target="base_rec" title="Sesli giriÅŸ">ğŸ¤</button>
              </div>
              <div class="hint-box" id="hint_base_rec">Hekimden bir aksiyon talep edin (reÃ§eteleme, deÄŸiÅŸtirme, baÅŸlama vb.).</div>
              <div class="fieldTools">
                <button class="btn ghost small" id="clear_base_rec">Temizle</button>
              </div>
            </div>
          </div>
          
          <!-- ğŸ“± FAZ 2: DRAFT BUTONLARI EKLENDÄ° -->
          <div class="fieldTools" style="justify-content: space-between; margin-top: 20px;">
            <div>
              <button class="btn ghost small" id="btnLoadDraft" style="display: none;">ğŸ“‚ Draft YÃ¼kle</button>
              <button class="btn ghost small" id="btnShowDrafts">ğŸ“‹ Draft Listesi</button>
            </div>
            <div>
              <button class="btn ghost small" id="btnClearAllDrafts">ğŸ—‘ï¸ TÃ¼mÃ¼nÃ¼ Temizle</button>
            </div>
          </div>
          
        </div>
      </details>
      
      <!-- ğŸ“ FAZ 1: OTOMATÄ°K CPR Ã–ZETÄ° BÃ–LÃœMÃœ -->
      <div class="cpr-section-card" style="margin-top: 20px; border-color: #3b82f6;">
        <div class="cpr-section-card::before" style="content: 'ğŸ¤– OTOMATÄ°K CPR Ã–ZETÄ°'; position: absolute; top: -10px; left: 16px; background: white; padding: 4px 10px; font-size: 11px; font-weight: 600; color: #1d4ed8; border: 1px solid #3b82f6; border-radius: 20px; letter-spacing: 0.02em; box-shadow: 0 2px 4px rgba(59, 130, 246, 0.1);">
          ğŸ¤– OTOMATÄ°K CPR Ã–ZETÄ°
        </div>
        
        <label for="autoCPR">BirleÅŸtirilmiÅŸ CPR Metni</label>
        <div class="textarea-wrapper">
          <textarea id="autoCPR" placeholder="Claim â†’ Ã–zellik â†’ Avantaj â†’ Fayda â†’ Recommendation birleÅŸmiÅŸ CPR metni burada otomatik oluÅŸur." readonly style="min-height: 120px; background-color: #f8fafc; border-color: #3b82f6;"></textarea>
          <button class="voice-btn" data-target="autoCPR" title="Sesli dÃ¼zenle">ğŸ¤</button>
        </div>
        
        <div class="fieldTools">
          <button class="btn ghost small" id="copyCPR">ğŸ“‹ Panoya Kopyala</button>
          <button class="btn ghost small" id="voiceReadCPR">ğŸ”Š Sesli Oku</button>
          <button class="btn ghost small" id="generateAutoCPRBtn">ğŸ”„ CPR OluÅŸtur</button>
        </div>
        
        <div class="hint-box show">
          <strong>ğŸ¤– Otomatik CPR Ã–zeti:</strong> TÃ¼m alanlarÄ± doldurdukÃ§a, sistem "[Problem + Etki]... Bu nedenle [Ã–zellik + Avantaj]. BÃ¶ylece [Fayda]. Bu yÃ¼zden [Recommendation]" ÅŸeklinde tek bir CPR cÃ¼mlesi oluÅŸturur.
        </div>
      </div>
      
      <!-- 4. STÄ°L BAZLI CPR'LAR KARTI (AKORDEON - KAPALI) -->
      <details class="acc" data-acc="styles" id="acc_styles">
        <summary>
          <div class="accTitle">
            <b><span class="arrow">â–¶</span> 2) Stil BazlÄ± CPR'lar</b>
            <span>Temel CPR'Ä± koruyarak hedef doktorun Ã¶ÄŸrenme stiline uyarlayÄ±n.</span>
          </div>
          <div class="accMeta">
            <span class="tag" id="mini_styles">4/4 stil kapalÄ±</span>
          </div>
        </summary>
        
        <div class="accBody">
          <div class="styleGrid">
            <!-- Aktivist -->
            <div class="styleCard" data-style="activist">
              <div class="styleHeader">
                <div>
                  <div class="styleTitle">Aktivist (DeÄŸiÅŸimci)</div>
                  <div class="styleBadge">
                    <span class="icon">ğŸ”¥</span>
                    <span>Yeni, deneyimsel, hÄ±zlÄ±</span>
                  </div>
                </div>
                <button class="btn small ghost" data-copy-base-to-style="activist">Temel CPR'Ä± Kopyala</button>
              </div>
              <div class="styleBody">
                Aktivist iÃ§in vurgu: <b>yeni deneyim, hÄ±zlÄ± sonuÃ§, hareket</b>.
                <ul>
                  <li>â€¢ Ä°lk cÃ¼mle: Probleme hÄ±zlÄ± giriÅŸ</li>
                  <li>â€¢ Ä°kinci cÃ¼mle: Etkiyi dramatize et</li>
                  <li>â€¢ Son cÃ¼mle: "Hemen" vurgulu Recommendation</li>
                </ul>
              </div>
              <div class="textarea-wrapper">
                <textarea class="styled-cpr-area" data-style="activist" id="activist_cpr" placeholder="Stile aktar butonuna basÄ±n veya buraya yazÄ±n... Aktivist CPR iÃ§in: hÄ±zlÄ±, dinamik, aksiyon odaklÄ± ifadeler kullanÄ±n."></textarea>
                <button class="voice-btn" data-target="activist_cpr" title="Sesli dÃ¼zenle">ğŸ¤</button>
              </div>
              <div class="feedback styleFeedback">
                <b>Geri bildirim:</b> Temel CPR â‰¥ 13 olduÄŸunda bu stil iÃ§in koÃ§luk mesajlarÄ± aktifleÅŸecek.
              </div>
            </div>
            
            <!-- ReflektÃ¶r -->
            <div class="styleCard" data-style="reflector">
              <div class="styleHeader">
                <div>
                  <div class="styleTitle">ReflektÃ¶r (Dikkatli GÃ¶zlemci)</div>
                  <div class="styleBadge reflector">
                    <span class="icon">ğŸ‘ï¸</span>
                    <span>Ã–nce gÃ¶zlem, sonra karar</span>
                  </div>
                </div>
                <button class="btn small ghost" data-copy-base-to-style="reflector">Temel CPR'Ä± Kopyala</button>
              </div>
              <div class="styleBody">
                ReflektÃ¶r iÃ§in vurgu: <b>veri, gÃ¶zlem, sakin analiz</b>.
                <ul>
                  <li>â€¢ Ä°lk cÃ¼mle: Problemi tablo gibi betimle</li>
                  <li>â€¢ Ä°kinci cÃ¼mle: Etkiyi gÃ¶zleme dayalÄ± anlat</li>
                  <li>â€¢ Son cÃ¼mle: "DÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼nÃ¼zde..." ile Recommendation</li>
                </ul>
              </div>
              <div class="textarea-wrapper">
                <textarea class="styled-cpr-area" data-style="reflector" id="reflector_cpr"
                  placeholder="Stile aktar butonuna basÄ±n veya buraya yazÄ±n... ReflektÃ¶r CPR iÃ§in: sakin, gÃ¶zleme dayalÄ±, veri referanslÄ± ifadeler kullanÄ±n." 
                 ></textarea>
                <button class="voice-btn" data-target="reflector_cpr" title="Sesli dÃ¼zenle">ğŸ¤</button>
              </div>
              <div class="feedback styleFeedback">
                <b>Geri bildirim:</b> Temel CPR â‰¥ 13 olduÄŸunda bu stil iÃ§in koÃ§luk mesajlarÄ± aktifleÅŸecek.
              </div>
            </div>
            
            <!-- Teorist -->
            <div class="styleCard" data-style="theorist">
              <div class="styleHeader">
                <div>
                  <div class="styleTitle">Teorist (Sistematik DÃ¼ÅŸÃ¼nen)</div>
                  <div class="styleBadge theorist">
                    <span class="icon">ğŸ“</span>
                    <span>KÄ±lavuz, mekanizma, sebep-sonuÃ§</span>
                  </div>
                </div>
                <button class="btn small ghost" data-copy-base-to-style="theorist">Temel CPR'Ä± Kopyala</button>
              </div>
              <div class="styleBody">
                Teorist iÃ§in vurgu: <b>kÄ±lavuz, mekanizma, rasyonel gerekÃ§e</b>.
                <ul>
                  <li>â€¢ Ä°lk cÃ¼mle: Problemi tanÄ±-tedavi iliÅŸkisiyle aÃ§</li>
                  <li>â€¢ Ä°kinci cÃ¼mle: Etkiyi patofizyoloji ile iliÅŸkilendir</li>
                  <li>â€¢ Son cÃ¼mle: KÄ±lavuz uyumu vurgulu Recommendation</li>
                </ul>
              </div>
              <div class="textarea-wrapper">
                <textarea class="styled-cpr-area" data-style="theorist" id="theorist_cpr"
                  placeholder="Stile aktar butonuna basÄ±n veya buraya yazÄ±n... Teorist CPR iÃ§in: sistematik, kÄ±lavuz referanslÄ± ve mekanizma temelli ifadeler kullanÄ±n." 
                 ></textarea>
                <button class="voice-btn" data-target="theorist_cpr" title="Sesli dÃ¼zenle">ğŸ¤</button>
              </div>
              <div class="feedback styleFeedback">
                <b>Geri bildirim:</b> Temel CPR â‰¥ 13 olduÄŸunda bu stil iÃ§in koÃ§luk mesajlarÄ± aktifleÅŸecek.
              </div>
            </div>
            
            <!-- Pragmatist -->
            <div class="styleCard" data-style="pragmatist">
              <div class="styleHeader">
                <div>
                  <div class="styleTitle">Pragmatist (UygulamacÄ±)</div>
                  <div class="styleBadge pragmatist">
                    <span class="icon">ğŸ› ï¸</span>
                    <span>Pratik, uygulanabilir, "iÅŸe yarar mÄ±?"</span>
                  </div>
                </div>
                <button class="btn small ghost" data-copy-base-to-style="pragmatist">Temel CPR'Ä± Kopyala</button>
              </div>
              <div class="styleBody">
                Pragmatist iÃ§in vurgu: <b>pratiklik, iÅŸ akÄ±ÅŸÄ±, kolaylÄ±k</b>.
                <ul>
                  <li>â€¢ Ä°lk cÃ¼mle: Problemi gÃ¼nlÃ¼k pratikten Ã¶rnekle</li>
                  <li>â€¢ Ä°kinci cÃ¼mle: Etkiyi iÅŸ yÃ¼kÃ¼ ve sÃ¼reklilikle baÄŸla</li>
                  <li>â€¢ Son cÃ¼mle: Rutin pratiÄŸe nasÄ±l oturduÄŸunu anlatan Recommendation</li>
                </ul>
              </div>
              
              <!-- ADIM 1: TEK CPR AlanÄ± -->
              <div class="style-badge pragmatist">ğŸ”„ UygulamacÄ± CPR'Ä±nÄ±z</div>
              <div class="textarea-wrapper">
                <textarea class="styled-cpr-area" data-style="pragmatist" id="pragmatist_cpr"
                  placeholder="Stile aktar butonuna basÄ±n veya buraya yazÄ±n... Pragmatist CPR iÃ§in: Pratik, uygulanabilir, "nasÄ±l yapÄ±lÄ±r" odaklÄ± ifadeler kullanÄ±n." 
                 ></textarea>
                <button class="voice-btn" data-target="pragmatist_cpr" title="Sesli dÃ¼zenle">ğŸ¤</button>
              </div>
              
              <div class="feedback styleFeedback">
                <b>Geri bildirim:</b> Temel CPR onaylandÄ±ktan sonra bu panel aktifleÅŸir.
              </div>
            </div>
          </div>
          
          <p class="footerNote">
            Mobil pratik: Temel CPR'Ä± geÃ§ â†’ Temel panel kapanÄ±r â†’ stile gir â†’ "Temel CPR'Ä± Kopyala" â†’ sadece gerekli kelimeleri deÄŸiÅŸtir â†’ kontrol et.
            <br><b>ğŸ“± ADIM 5 YENÄ°LÄ°KLERÄ°:</b> Sesli giriÅŸ, mobil klavye kÄ±sayollarÄ±, offline draft kaydetme aktif!
          </p>
        </div>
      </details>
    </main>
  </div>
  
  <!-- ğŸ“± FAZ 2: MOBÄ°L BÄ°LDÄ°RÄ°M ALANI -->
  <div id="mobileNotificationArea"></div>
  
  <script>
  // ============================================
  // ğŸ“± FAZ 1: OTOMATÄ°K CPR Ã–ZETÄ° ÃœRETÄ°MÄ° (GÃœNCELLENDÄ°)
  // ============================================
  
  const AutoCPRGenerator = {
    generate: function() {
      const problem = document.getElementById('base_claim_problem')?.value.trim() || '';
      const effect = document.getElementById('base_claim_effect')?.value.trim() || '';
      const feature = document.getElementById('base_feat')?.value.trim() || '';
      const advantage = document.getElementById('base_adv')?.value.trim() || '';
      const benefit = document.getElementById('base_ben')?.value.trim() || '';
      const recommendation = document.getElementById('base_rec')?.value.trim() || '';
      
      if (!problem && !effect && !feature && !advantage && !benefit && !recommendation) {
        return '';
      }
      
      let autoCPR = '';
      
      if (problem && effect) {
        autoCPR += `"${problem} Bu durum ${effect.toLowerCase()}... `;
      } else if (problem) {
        autoCPR += `"${problem}... `;
      } else if (effect) {
        autoCPR += `"${effect}... `;
      }
      
      if (feature && advantage) {
        autoCPR += `Bu nedenle ${feature}, ${advantage.toLowerCase()}. `;
      } else if (feature) {
        autoCPR += `Bu nedenle ${feature}. `;
      } else if (advantage) {
        autoCPR += `Bu nedenle ${advantage}. `;
      }
      
      if (benefit) {
        autoCPR += `BÃ¶ylece ${benefit}. `;
      }
      
      if (recommendation) {
        const hasQuestionMark = recommendation.trim().endsWith('?');
        autoCPR += `Bu yÃ¼zden ${recommendation}${!hasQuestionMark ? '?' : ''}"`;
      } else {
        autoCPR = autoCPR.trim();
        if (!autoCPR.endsWith('"')) {
          autoCPR += '"';
        }
      }
      
      return autoCPR;
    },
    
    updateAutoCPR: function() {
      const autoCPR = this.generate();
      const autoCPRTextarea = document.getElementById('autoCPR');
      
      if (autoCPRTextarea) {
        autoCPRTextarea.value = autoCPR;
        
        const voiceReadBtn = document.getElementById('voiceReadCPR');
        if (voiceReadBtn && autoCPR.length > 20) {
          voiceReadBtn.disabled = false;
        }
      }
    },
    
    copyToClipboard: function() {
      const autoCPR = document.getElementById('autoCPR')?.value;
      
      if (!autoCPR || autoCPR.trim().length < 10) {
        MobileFeatures.showNotification('Kopyalanacak CPR metni yok', 'warning');
        return;
      }
      
      navigator.clipboard.writeText(autoCPR).then(() => {
        MobileFeatures.showNotification('CPR panoya kopyalandÄ±', 'success');
      }).catch(err => {
        console.error('Kopyalama hatasÄ±:', err);
        MobileFeatures.showNotification('Kopyalama baÅŸarÄ±sÄ±z', 'error');
      });
    },
    
    readAloud: function() {
      const autoCPR = document.getElementById('autoCPR')?.value;
      
      if (!autoCPR || autoCPR.trim().length < 10) {
        MobileFeatures.showNotification('Okunacak CPR metni yok', 'warning');
        return;
      }
      
      if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(autoCPR);
        utterance.lang = 'tr-TR';
        utterance.rate = 1.0;
        utterance.pitch = 1.0;
        utterance.volume = 1.0;
        
        utterance.onstart = () => {
          MobileFeatures.showNotification('CPR okunuyor...', 'info');
        };
        
        utterance.onend = () => {
          MobileFeatures.showNotification('CPR okuma tamamlandÄ±', 'success');
        };
        
        speechSynthesis.speak(utterance);
      } else {
        MobileFeatures.showNotification('TarayÄ±cÄ±nÄ±z sesli okumayÄ± desteklemiyor', 'warning');
      }
    },
    
    init: function() {
      const textareas = [
        'base_claim_problem', 'base_claim_effect', 
        'base_feat', 'base_adv', 'base_ben', 'base_rec'
      ];
      
      textareas.forEach(id => {
        const textarea = document.getElementById(id);
        if (textarea) {
          textarea.addEventListener('input', () => {
            this.updateAutoCPR();
          });
        }
      });
      
      const generateBtn = document.getElementById('generateAutoCPRBtn');
      if (generateBtn) {
        generateBtn.addEventListener('click', () => {
          this.updateAutoCPR();
          MobileFeatures.showNotification('CPR otomatik oluÅŸturuldu', 'success');
        });
      }
      
      const copyBtn = document.getElementById('copyCPR');
      if (copyBtn) {
        copyBtn.addEventListener('click', () => {
          this.copyToClipboard();
        });
      }
      
      const voiceReadBtn = document.getElementById('voiceReadCPR');
      if (voiceReadBtn) {
        voiceReadBtn.addEventListener('click', () => {
          this.readAloud();
        });
      }
      
      setTimeout(() => {
        this.updateAutoCPR();
      }, 500);
      
      console.log('âœ… Otomatik CPR Ãœretimi sistemi hazÄ±r');
    }
  };
  
  // ============================================
  // ğŸ“„ YENÄ°: TÃœM RAPOR PDF SÄ°STEMÄ° (KAPSAMLI)
  // ============================================
  
  const ComprehensivePDFReport = {
    generateFullReport: function() {
      try {
        const fullReportBtn = document.getElementById('fullReportPDF');
        const originalText = fullReportBtn.innerHTML;
        const originalBackground = fullReportBtn.style.background;
        
        fullReportBtn.innerHTML = 'ğŸ“„ OluÅŸturuluyor...';
        fullReportBtn.style.background = '#9ca3af';
        fullReportBtn.style.cursor = 'wait';
        
        setTimeout(() => {
          const reportData = this.collectAllData();
          const docDefinition = this.createFullDocumentDefinition(reportData);
          
          const fileName = `FAST_CPR_Tum_Rapor_${new Date().toISOString().slice(0, 10)}.pdf`;
          pdfMake.createPdf(docDefinition).download(fileName);
          
          MobileFeatures.showNotification('TÃ¼m rapor PDF olarak indiriliyor...', 'success');
          
          fullReportBtn.innerHTML = originalText;
          fullReportBtn.style.background = originalBackground;
          fullReportBtn.style.cursor = 'pointer';
        }, 500);
        
      } catch (error) {
        console.error('PDF oluÅŸturma hatasÄ±:', error);
        MobileFeatures.showNotification('PDF oluÅŸturulurken hata oluÅŸtu', 'error');
        
        const fullReportBtn = document.getElementById('fullReportPDF');
        fullReportBtn.innerHTML = 'ğŸ“„ TÃ¼m Raporu PDF\'e Aktar';
        fullReportBtn.style.background = '#3b82f6';
        fullReportBtn.style.cursor = 'pointer';
      }
    },
    
    collectAllData: function() {
      return {
        // A. ZÄ°YARET Ã–NCESÄ° HAZIRLIK
        preparation: {
          promoContext: document.getElementById('promoContext')?.value.trim() || 'â€”',
          learningStyle: document.getElementById('learningStyle')?.value.trim() || 'â€”',
          promoGoal: document.getElementById('promoGoal')?.value.trim() || 'â€”',
          flexBehaviors: document.getElementById('flexBehaviors')?.value.trim() || 'â€”'
        },
        
        // B. ÃœRÃœN ODAK & HAZIRLIK
        productPrep: {
          productName: document.getElementById('productNameInput')?.value.trim() || 'â€”',
          competitorName: document.getElementById('competitorNameInput')?.value.trim() || 'â€”',
          superiority: document.getElementById('superiorityInput')?.value.trim() || 'â€”',
          benefits: document.getElementById('benefitTextArea')?.value.trim() || 'â€”'
        },
        
        // C. TEMEL CPR
        baseCPR: {
          claim_problem: document.getElementById('base_claim_problem')?.value.trim() || 'â€”',
          claim_effect: document.getElementById('base_claim_effect')?.value.trim() || 'â€”',
          feature: document.getElementById('base_feat')?.value.trim() || 'â€”',
          advantage: document.getElementById('base_adv')?.value.trim() || 'â€”',
          benefit: document.getElementById('base_ben')?.value.trim() || 'â€”',
          recommendation: document.getElementById('base_rec')?.value.trim() || 'â€”'
        },
        
        // D. STÄ°L CPR'LARI
        styleCPRs: {
          activist: document.getElementById('activist_cpr')?.value.trim() || 'â€”',
          reflector: document.getElementById('reflector_cpr')?.value.trim() || 'â€”',
          theorist: document.getElementById('theorist_cpr')?.value.trim() || 'â€”',
          pragmatist: document.getElementById('pragmatist_cpr')?.value.trim() || 'â€”'
        },
        
        // Metadata
        generatedAt: new Date().toLocaleString('tr-TR'),
        date: new Date().toLocaleDateString('tr-TR'),
        time: new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' })
      };
    },
    
    createFullDocumentDefinition: function(data) {
      return {
        pageSize: 'A4',
        pageMargins: [40, 80, 40, 60],
        
        // HEADER: BaÅŸlÄ±k ve Tarih
        header: function(currentPage, pageCount) {
          return [
            // BAÅLIK: FAST CPR KoÃ§u (Ã¼st orta)
            {
              text: 'FAST CPR KOÃ‡U',
              style: 'mainHeader',
              alignment: 'center',
              margin: [0, 20, 0, 0]
            },
            
            // TARÄ°H: SaÄŸ Ã¼st kÃ¶ÅŸe, baÅŸlÄ±ktan 20px aÅŸaÄŸÄ±da
            {
              text: data.date + ' ' + data.time,
              style: 'dateHeader',
              alignment: 'right',
              margin: [0, 40, 40, 0]
            }
          ];
        },
        
        content: [
          // 1. ZÄ°YARET Ã–NCESÄ° HAZIRLIK BÃ–LÃœMÃœ
          {
            text: '1. ZÄ°YARET Ã–NCESÄ° HAZIRLIK',
            style: 'sectionHeader',
            pageBreak: 'before',
            margin: [0, 30, 0, 10]
          },
          this.createPreparationSection(data.preparation),
          
          // 2. ÃœRÃœN ODAK & HAZIRLIK BÃ–LÃœMÃœ
          {
            text: '2. ÃœRÃœN ODAK & HAZIRLIK',
            style: 'sectionHeader',
            margin: [0, 20, 0, 10]
          },
          this.createProductPrepSection(data.productPrep),
          
          // 3. TEMEL CPR BÃ–LÃœMÃœ
          {
            text: '3. TEMEL CPR',
            style: 'sectionHeader',
            margin: [0, 20, 0, 10]
          },
          this.createBaseCPRSection(data.baseCPR),
          
          // 4. STÄ°L CPR'LARI BÃ–LÃœMÃœ
          {
            text: '4. Ã–ÄRENME STÄ°LLERÄ°NE GÃ–RE CPR\'LAR',
            style: 'sectionHeader',
            margin: [0, 20, 0, 10]
          },
          this.createStyleCPRSection(data.styleCPRs),
          
          // FOOTER NOTU
          {
            text: 'FAST CPR KoÃ§u tarafÄ±ndan oluÅŸturulmuÅŸtur â€¢ ' + data.generatedAt,
            style: 'footer',
            margin: [0, 30, 0, 0]
          }
        ],
        
        styles: {
          // ANA BAÅLIK
          mainHeader: {
            fontSize: 20,
            bold: true,
            color: '#1d4ed8'
          },
          
          // TARÄ°H BAÅLIÄI
          dateHeader: {
            fontSize: 10,
            color: '#666',
            italics: true
          },
          
          // BÃ–LÃœM BAÅLIKLARI
          sectionHeader: {
            fontSize: 14,
            bold: true,
            color: '#1e40af',
            background: '#eff6ff',
            padding: [8, 4],
            border: [1, 'solid', '#dbeafe'],
            marginBottom: 8
          },
          
          // ALT BAÅLIKLAR
          subsection: {
            fontSize: 12,
            bold: true,
            color: '#374151',
            margin: [0, 8, 0, 4]
          },
          
          // Ä°Ã‡ERÄ°K METNÄ°
          contentText: {
            fontSize: 11,
            lineHeight: 1.4,
            margin: [0, 0, 0, 6]
          },
          
          // Ä°TALÄ°K CPR METNÄ° (stiller iÃ§in)
          italicCPR: {
            fontSize: 11,
            italics: true,
            lineHeight: 1.4,
            background: '#f8fafc',
            padding: [8, 10],
            border: [1, 'dashed', '#e5e7eb'],
            margin: [0, 4, 0, 12]
          },
          
          // FOOTER
          footer: {
            fontSize: 9,
            color: '#6b7280',
            alignment: 'center',
            italics: true
          },
          
          // LABEL (etiket)
          label: {
            fontSize: 11,
            bold: true,
            color: '#4b5563'
          },
          
          // VALUE (deÄŸer)
          value: {
            fontSize: 11,
            color: '#111827',
            margin: [0, 0, 0, 8]
          }
        }
      };
    },
    
    createPreparationSection: function(prep) {
      return [
        {
          text: [{ text: 'Doktor/EczacÄ±nÄ±n Sosyal Stili: ', style: 'label' }, prep.promoContext],
          style: 'contentText'
        },
        {
          text: [{ text: 'Esneme DavranÄ±ÅŸlarÄ±: ', style: 'label' }, prep.flexBehaviors],
          style: 'contentText'
        },
        {
          text: [{ text: 'Ã–ÄŸrenme Stili: ', style: 'label' }, prep.learningStyle],
          style: 'contentText'
        },
        {
          text: [{ text: 'SMART CPR Hedefi: ', style: 'label' }, prep.promoGoal],
          style: 'contentText',
          margin: [0, 0, 0, 16]
        }
      ];
    },
    
    createProductPrepSection: function(product) {
      return [
        {
          text: [{ text: 'ÃœrÃ¼n: ', style: 'label' }, product.productName],
          style: 'contentText'
        },
        {
          text: [{ text: 'Rakip: ', style: 'label' }, product.competitorName],
          style: 'contentText'
        },
        {
          text: [{ text: 'ÃœstÃ¼n YÃ¶n: ', style: 'label' }, product.superiority],
          style: 'contentText'
        },
        {
          text: [{ text: 'Sunulacak Fayda: ', style: 'label' }, product.benefits],
          style: 'contentText',
          margin: [0, 0, 0, 16]
        }
      ];
    },
    
    createBaseCPRSection: function(cpr) {
      return [
        {
          text: 'CLAIM - Problem:',
          style: 'subsection'
        },
        {
          text: cpr.claim_problem,
          style: 'value'
        },
        {
          text: 'CLAIM - Etki:',
          style: 'subsection'
        },
        {
          text: cpr.claim_effect,
          style: 'value'
        },
        {
          text: 'PROPOSITION - Ã–zellik:',
          style: 'subsection'
        },
        {
          text: cpr.feature,
          style: 'value'
        },
        {
          text: 'PROPOSITION - Avantaj:',
          style: 'subsection'
        },
        {
          text: cpr.advantage,
          style: 'value'
        },
        {
          text: 'PROPOSITION - Fayda:',
          style: 'subsection'
        },
        {
          text: cpr.benefit,
          style: 'value'
        },
        {
          text: 'RECOMMENDATION:',
          style: 'subsection'
        },
        {
          text: cpr.recommendation,
          style: 'value',
          margin: [0, 0, 0, 16]
        }
      ];
    },
    
    createStyleCPRSection: function(styles) {
      return [
        // AKTÄ°VÄ°ST CPR
        {
          text: 'Aktivist CPR',
          style: 'subsection'
        },
        {
          text: styles.activist,
          style: 'italicCPR'
        },
        
        // REFLEKTÃ–R CPR
        {
          text: 'ReflektÃ¶r CPR',
          style: 'subsection'
        },
        {
          text: styles.reflector,
          style: 'italicCPR'
        },
        
        // TEORÄ°ST CPR
        {
          text: 'Teorist CPR',
          style: 'subsection'
        },
        {
          text: styles.theorist,
          style: 'italicCPR'
        },
        
        // PRAGMATÄ°ST CPR
        {
          text: 'Pragmatist CPR',
          style: 'subsection'
        },
        {
          text: styles.pragmatist,
          style: 'italicCPR',
          margin: [0, 4, 0, 0]
        }
      ];
    }
  };
  
  // ============================================
  // ğŸ“± FAZ 4: SESLÄ° GÄ°RÄ°Å GELÄ°ÅTÄ°RMELERÄ°
  // ============================================
  
  const MobileFeatures = {
    // 1. GELÄ°ÅMÄ°Å SESLÄ° GÄ°RÄ°Å SÄ°STEMÄ°
    SpeechToText: {
      recognition: null,
      isListening: false,
      currentTarget: null,
      voiceIndicator: null,
      
      init: function() {
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
          const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
          this.recognition = new SpeechRecognition();
          this.recognition.continuous = false;
          this.recognition.interimResults = true;
          this.recognition.lang = 'tr-TR';
          this.recognition.maxAlternatives = 3;
          
          this.recognition.onstart = () => {
            this.isListening = true;
            this.showListeningStatus(true);
            this.playSound('start');
            this.showVoiceIndicator();
          };
          
          this.recognition.onresult = (event) => {
            let finalTranscript = '';
            let interimTranscript = '';
            
            for (let i = event.resultIndex; i < event.results.length; ++i) {
              if (event.results[i].isFinal) {
                finalTranscript += event.results[i][0].transcript;
                this.playSound('success');
              } else {
                interimTranscript += event.results[i][0].transcript;
              }
            }
            
            if (this.currentTarget && (finalTranscript || interimTranscript)) {
              const textarea = document.getElementById(this.currentTarget);
              if (textarea) {
                if (finalTranscript) {
                  const currentText = textarea.value;
                  textarea.value = currentText + (currentText ? ' ' : '') + finalTranscript;
                  textarea.dispatchEvent(new Event('input', { bubbles: true }));
                  
                  if (typeof AutoCPRGenerator !== 'undefined') {
                    AutoCPRGenerator.updateAutoCPR();
                  }
                  
                  this.showVoiceFeedback('âœ“ Eklendi');
                }
                
                if (interimTranscript && this.voiceIndicator) {
                  this.voiceIndicator.querySelector('.voice-text').textContent = interimTranscript;
                }
              }
            }
          };
          
          this.recognition.onerror = (event) => {
            console.error('Ses tanÄ±ma hatasÄ±:', event.error);
            this.showNotification('Ses tanÄ±ma hatasÄ±: ' + this.getErrorMessage(event.error), 'error');
            this.playSound('error');
            this.hideVoiceIndicator();
          };
          
          this.recognition.onend = () => {
            this.isListening = false;
            this.showListeningStatus(false);
            this.hideVoiceIndicator();
            this.currentTarget = null;
          };
          
          console.log('âœ… GeliÅŸmiÅŸ sesli giriÅŸ sistemi hazÄ±r');
        } else {
          console.warn('âš ï¸ Bu tarayÄ±cÄ± ses tanÄ±mayÄ± desteklemiyor');
          document.querySelectorAll('.voice-btn').forEach(btn => {
            btn.style.opacity = '0.5';
            btn.title = 'Sesli giriÅŸ desteklenmiyor';
            btn.disabled = true;
          });
        }
      },
      
      startListening: function(targetId) {
        if (!this.recognition) {
          this.showNotification('Sesli giriÅŸ desteklenmiyor', 'error');
          return;
        }
        
        if (this.isListening && this.currentTarget === targetId) {
          this.stopListening();
          return;
        }
        
        this.currentTarget = targetId;
        try {
          this.recognition.start();
        } catch (error) {
          console.error('Ses tanÄ±ma baÅŸlatma hatasÄ±:', error);
          this.showNotification('Ses tanÄ±ma baÅŸlatÄ±lamadÄ±', 'error');
        }
      },
      
      stopListening: function() {
        if (this.recognition && this.isListening) {
          this.recognition.stop();
        }
      },
      
      toggleListening: function(targetId) {
        if (this.isListening && this.currentTarget === targetId) {
          this.stopListening();
        } else {
          this.startListening(targetId);
        }
      },
      
      showListeningStatus: function(isListening) {
        const buttons = document.querySelectorAll('.voice-btn');
        buttons.forEach(btn => {
          if (btn.dataset.target === this.currentTarget) {
            btn.classList.toggle('listening', isListening);
            btn.innerHTML = isListening ? 'ğŸ”´' : 'ğŸ¤';
            btn.title = isListening ? 'Dinleniyor... (durdurmak iÃ§in tÄ±kla)' : 'Sesli giriÅŸ';
          }
        });
      },
      
      showVoiceIndicator: function() {
        if (this.voiceIndicator) {
          this.voiceIndicator.remove();
        }
        
        this.voiceIndicator = document.createElement('div');
        this.voiceIndicator.className = 'voice-indicator';
        this.voiceIndicator.innerHTML = `
          <div class="pulse"></div>
          <span class="voice-text">Dinleniyor... KonuÅŸmaya baÅŸlayÄ±n</span>
          <button class="btn ghost small" id="stopVoiceBtn" style="margin-left: 10px; padding: 2px 8px; font-size: 11px;">Durdur</button>
        `;
        
        document.body.appendChild(this.voiceIndicator);
        
        document.getElementById('stopVoiceBtn').addEventListener('click', () => {
          this.stopListening();
        });
      },
      
      hideVoiceIndicator: function() {
        if (this.voiceIndicator) {
          this.voiceIndicator.remove();
          this.voiceIndicator = null;
        }
      },
      
      showVoiceFeedback: function(message) {
        const textarea = document.getElementById(this.currentTarget);
        if (!textarea) return;
        
        const feedback = document.createElement('div');
        feedback.className = 'voice-feedback';
        feedback.textContent = message;
        
        const wrapper = textarea.parentElement;
        wrapper.appendChild(feedback);
        
        setTimeout(() => {
          if (feedback.parentElement) {
            feedback.remove();
          }
        }, 1500);
      },
      
      playSound: function(type) {
        try {
          const audioContext = new (window.AudioContext || window.webkitAudioContext)();
          
          if (type === 'start') {
            const oscillator = audioContext.createOscillator();
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.connect(audioContext.destination);
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.1);
          } else if (type === 'success') {
            const oscillator = audioContext.createOscillator();
            oscillator.frequency.setValueAtTime(1200, audioContext.currentTime);
            oscillator.connect(audioContext.destination);
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.1);
          }
        } catch (error) {
          // Ses API'si desteklenmiyorsa sessiz devam et
        }
      },
      
      getErrorMessage: function(errorCode) {
        const errors = {
          'no-speech': 'KonuÅŸma algÄ±lanamadÄ±',
          'audio-capture': 'Mikrofon eriÅŸimi yok',
          'not-allowed': 'Mikrofon izni verilmedi',
          'network': 'AÄŸ hatasÄ±',
          'aborted': 'Ä°ÅŸlem iptal edildi',
          'service-not-allowed': 'Servis izni yok'
        };
        return errors[errorCode] || 'Bilinmeyen hata';
      },
      
      showNotification: function(message, type = 'info') {
        MobileFeatures.showNotification(message, type);
      }
    },
    
    // 2. BAÄLANTI DURUM YÃ–NETÄ°CÄ°SÄ°
    ConnectivityManager: {
      init: function() {
        const offlineStatus = document.getElementById('offlineStatus');
        const connectivityText = document.getElementById('connectivityText');
        
        if (!offlineStatus || !connectivityText) return;
        
        this.updateStatus();
        
        window.addEventListener('online', () => {
          this.updateStatus();
          this.showNotification('Ä°nternet baÄŸlantÄ±sÄ± yeniden saÄŸlandÄ±', 'success');
          
          setTimeout(() => {
            if (typeof MobileFeatures.DraftSystem !== 'undefined') {
              MobileFeatures.DraftSystem.saveDraft(false);
            }
          }, 1000);
        });
        
        window.addEventListener('offline', () => {
          this.updateStatus();
          this.showNotification('Ä°nternet baÄŸlantÄ±sÄ± kesildi. Offline mod aktif.', 'warning');
        });
        
        console.log('âœ… Connectivity Manager hazÄ±r');
      },
      
      updateStatus: function() {
        const offlineStatus = document.getElementById('offlineStatus');
        const connectivityText = document.getElementById('connectivityText');
        
        if (!offlineStatus || !connectivityText) return;
        
        if (navigator.onLine) {
          offlineStatus.classList.remove('offline');
          offlineStatus.classList.add('online');
          connectivityText.textContent = 'Ã‡evrimiÃ§i';
          offlineStatus.title = 'Ä°nternet baÄŸlantÄ±sÄ± aktif';
          
          setTimeout(() => {
            if (navigator.onLine) {
              offlineStatus.style.opacity = '0';
              offlineStatus.style.transform = 'translateY(-10px)';
              setTimeout(() => {
                if (navigator.onLine) {
                  offlineStatus.style.display = 'none';
                }
              }, 300);
            }
          }, 3000);
        } else {
          offlineStatus.classList.remove('online');
          offlineStatus.classList.add('offline');
          connectivityText.textContent = 'Ã‡evrimdÄ±ÅŸÄ±';
          offlineStatus.title = 'Ä°nternet baÄŸlantÄ±sÄ± yok';
          offlineStatus.style.display = 'flex';
          offlineStatus.style.opacity = '1';
          offlineStatus.style.transform = 'translateY(0)';
        }
      },
      
      showNotification: function(message, type = 'info') {
        MobileFeatures.showNotification(message, type);
      }
    },
    
    // 3. SESLÄ° OKUMA SÄ°STEMÄ°
    TextToSpeech: {
      init: function() {
        const readBtn = document.getElementById('voiceReadCPR');
        if (readBtn && 'speechSynthesis' in window) {
          readBtn.style.display = 'inline-block';
        } else if (readBtn) {
          readBtn.style.display = 'none';
        }
        console.log('âœ… Sesli okuma sistemi hazÄ±r');
      },
      
      readCPR: function() {
        const cprText = document.getElementById('autoCPR')?.value;
        if (!cprText || cprText.trim().length < 10) {
          this.showNotification('Okunacak CPR metni bulunamadÄ±', 'warning');
          return;
        }
        
        if ('speechSynthesis' in window) {
          speechSynthesis.cancel();
          
          const utterance = new SpeechSynthesisUtterance(cprText);
          utterance.lang = 'tr-TR';
          utterance.rate = 0.9;
          utterance.pitch = 1.0;
          utterance.volume = 1.0;
          
          utterance.onstart = () => {
            this.showNotification('CPR okunuyor...', 'info');
            document.getElementById('voiceReadCPR').innerHTML = 'â¸ï¸ Durdur';
          };
          
          utterance.onend = () => {
            this.showNotification('CPR okuma tamamlandÄ±', 'success');
            document.getElementById('voiceReadCPR').innerHTML = 'ğŸ”Š Sesli Oku';
          };
          
          utterance.onerror = () => {
            this.showNotification('Okuma sÄ±rasÄ±nda hata oluÅŸtu', 'error');
            document.getElementById('voiceReadCPR').innerHTML = 'ğŸ”Š Sesli Oku';
          };
          
          speechSynthesis.speak(utterance);
          
          const voiceBtn = document.getElementById('voiceReadCPR');
          voiceBtn.onclick = () => {
            if (speechSynthesis.speaking) {
              speechSynthesis.cancel();
              voiceBtn.innerHTML = 'ğŸ”Š Sesli Oku';
              this.showNotification('Okuma durduruldu', 'info');
            } else {
              this.readCPR();
            }
          };
        } else {
          this.showNotification('TarayÄ±cÄ±nÄ±z sesli okumayÄ± desteklemiyor', 'warning');
        }
      },
      
      showNotification: function(message, type = 'info') {
        MobileFeatures.showNotification(message, type);
      }
    },
    
    // 4. KOPYALAMA SÄ°STEMÄ°
    ClipboardSystem: {
      init: function() {
        const copyBtn = document.getElementById('copyCPR');
        if (copyBtn) {
          copyBtn.addEventListener('click', () => {
            this.copyCPRToClipboard();
          });
        }
        
        const toolbarCopyBtn = document.querySelector('.mobile-toolbar button[data-action="copy"]');
        if (toolbarCopyBtn) {
          toolbarCopyBtn.addEventListener('click', () => {
            this.copyActiveTextarea();
          });
        }
        console.log('âœ… Kopyalama sistemi hazÄ±r');
      },
      
      copyCPRToClipboard: function() {
        const autoCPR = document.getElementById('autoCPR')?.value;
        
        if (!autoCPR || autoCPR.trim().length < 10) {
          this.showNotification('Kopyalanacak CPR metni yok', 'warning');
          return;
        }
        
        this.copyTextToClipboard(autoCPR, 'CPR panoya kopyalandÄ±');
      },
      
      copyActiveTextarea: function() {
        const activeTextarea = document.activeElement;
        if (!activeTextarea || activeTextarea.tagName !== 'TEXTAREA') {
          this.showNotification('Ã–nce bir metin alanÄ±na tÄ±klayÄ±n', 'info');
          return;
        }
        
        const text = activeTextarea.value;
        if (!text || text.trim().length === 0) {
          this.showNotification('Kopyalanacak metin yok', 'warning');
          return;
        }
        
        this.copyTextToClipboard(text, 'Metin panoya kopyalandÄ±');
      },
      
      copyTextToClipboard: function(text, successMessage) {
        if (!navigator.clipboard) {
          this.fallbackCopyTextToClipboard(text, successMessage);
          return;
        }
        
        navigator.clipboard.writeText(text).then(() => {
          this.showNotification(successMessage, 'success');
        }).catch(err => {
          console.error('Kopyalama hatasÄ±:', err);
          this.fallbackCopyTextToClipboard(text, successMessage);
        });
      },
      
      fallbackCopyTextToClipboard: function(text, successMessage) {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.position = "fixed";
        textArea.style.opacity = "0";
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        try {
          const successful = document.execCommand('copy');
          if (successful) {
            this.showNotification(successMessage, 'success');
          } else {
            this.showNotification('Kopyalama baÅŸarÄ±sÄ±z', 'error');
          }
        } catch (err) {
          console.error('Fallback kopyalama hatasÄ±:', err);
          this.showNotification('Kopyalama baÅŸarÄ±sÄ±z', 'error');
        }
        
        document.body.removeChild(textArea);
      },
      
      showNotification: function(message, type = 'info') {
        MobileFeatures.showNotification(message, type);
      }
    },
    
    // 5. PDF RAPOR SÄ°STEMÄ° (ESKÄ° - KALDIRILDI)
    PDFReportSystem: {
      init: function() {
        console.log('âœ… PDF Rapor sistemi hazÄ±r (eski sistem)');
      }
    },
    
    // 6. DRAFT SÄ°STEMÄ°
    DraftSystem: {
      storageKey: 'fastcpr_drafts_v2',
      autoSaveInterval: null,
      lastSaveTime: null,
      
      init: function() {
        this.setupAutoSave();
        this.setupDraftButtons();
        this.updateDraftIndicator();
        
        window.addEventListener('load', () => {
          const hasDrafts = this.hasDrafts();
          if (hasDrafts) {
            this.showNotification('KayÄ±tlÄ± draft bulundu. YÃ¼klemek iÃ§in "Draft Listesi" butonunu kullanÄ±n.', 'info');
          }
        });
        
        window.addEventListener('beforeunload', (e) => {
          this.saveDraft();
        });
        
        console.log('âœ… Draft Sistemi hazÄ±r');
      },
      
      setupAutoSave: function() {
        this.autoSaveInterval = setInterval(() => {
          this.saveDraft(false);
        }, 30000);
        
        document.querySelectorAll('textarea').forEach(textarea => {
          textarea.addEventListener('input', () => {
            this.updateDraftIndicator();
          });
        });
      },
      
      setupDraftButtons: function() {
        const saveBtn = document.getElementById('btnSaveDraft');
        const loadBtn = document.getElementById('btnLoadDraft');
        const showDraftsBtn = document.getElementById('btnShowDrafts');
        const clearAllBtn = document.getElementById('btnClearAllDrafts');
        
        if (saveBtn) {
          saveBtn.addEventListener('click', () => {
            this.saveDraft(true);
          });
        }
        
        if (showDraftsBtn) {
          showDraftsBtn.addEventListener('click', () => {
            this.showDraftSelector();
          });
        }
        
        if (clearAllBtn) {
          clearAllBtn.addEventListener('click', () => {
            if (confirm('TÃ¼m draft\'larÄ± silmek istediÄŸinize emin misiniz? Bu iÅŸlem geri alÄ±namaz.')) {
              localStorage.removeItem(this.storageKey);
              this.updateDraftIndicator();
              this.showNotification('TÃ¼m draft\'lar silindi', 'success');
            }
          });
        }
      },
      
      getCurrentData: function() {
        return {
          claim_problem: document.getElementById('base_claim_problem')?.value || '',
          claim_effect: document.getElementById('base_claim_effect')?.value || '',
          feature: document.getElementById('base_feat')?.value || '',
          advantage: document.getElementById('base_adv')?.value || '',
          benefit: document.getElementById('base_ben')?.value || '',
          recommendation: document.getElementById('base_rec')?.value || '',
          autoCPR: document.getElementById('autoCPR')?.value || '',
          
          promoContext: document.getElementById('promoContext')?.value || '',
          learningStyle: document.getElementById('learningStyle')?.value || '',
          promoGoal: document.getElementById('promoGoal')?.value || '',
          flexBehaviors: document.getElementById('flexBehaviors')?.value || '',
          
          productName: document.getElementById('productNameInput')?.value || '',
          competitorName: document.getElementById('competitorNameInput')?.value || '',
          superiority: document.getElementById('superiorityInput')?.value || '',
          benefitCustom: document.getElementById('benefitCustomInput')?.value || '',
          
          timestamp: new Date().toISOString(),
          lastModified: Date.now(),
          name: `Draft_${new Date().toLocaleTimeString('tr-TR', {hour: '2-digit', minute:'2-digit'})}`,
          version: '2.0'
        };
      },
      
      saveDraft: function(manual = false) {
        try {
          const data = this.getCurrentData();
          
          const hasContent = Object.values(data).some(val => 
            typeof val === 'string' && val.trim().length > 0 && 
            !['timestamp', 'lastModified', 'name', 'version'].includes(val)
          );
          
          if (!hasContent && !manual) {
            return false;
          }
          
          const drafts = this.getAllDrafts();
          
          drafts.unshift({
            ...data,
            id: Date.now(),
            name: manual ? `Manual_${new Date().toLocaleTimeString('tr-TR')}` : data.name
          });
          
          if (drafts.length > 10) {
            drafts.length = 10;
          }
          
          localStorage.setItem(this.storageKey, JSON.stringify(drafts));
          this.lastSaveTime = Date.now();
          
          this.updateDraftIndicator();
          
          if (manual) {
            this.showNotification('Draft kaydedildi', 'success');
          }
          
          return true;
        } catch (error) {
          console.error('Draft kaydetme hatasÄ±:', error);
          if (manual) {
            this.showNotification('Draft kaydedilemedi', 'error');
          }
          return false;
        }
      },
      
      getAllDrafts: function() {
        try {
          const saved = localStorage.getItem(this.storageKey);
          return saved ? JSON.parse(saved) : [];
        } catch (error) {
          console.error('Draft\'lar okunamadÄ±:', error);
          return [];
        }
      },
      
      hasDrafts: function() {
        return this.getAllDrafts().length > 0;
      },
      
      updateDraftIndicator: function() {
        const indicator = document.getElementById('draftIndicator');
        const loadBtn = document.getElementById('btnLoadDraft');
        
        if (!indicator) return;
        
        const drafts = this.getAllDrafts();
        if (drafts.length > 0) {
          indicator.classList.add('saved');
          indicator.innerHTML = `ğŸ’¾ ${drafts.length} Draft`;
          indicator.title = `${drafts.length} kayÄ±tlÄ± draft var. Son kayÄ±t: ${drafts[0]?.timestamp ? new Date(drafts[0].timestamp).toLocaleTimeString('tr-TR') : 'bilinmiyor'}`;
          
          indicator.onclick = () => {
            this.showDraftSelector();
          };
          
          if (loadBtn) loadBtn.style.display = 'inline-block';
        } else {
          indicator.classList.remove('saved');
          indicator.innerHTML = 'ğŸ’¾ Draft Yok';
          indicator.title = 'HenÃ¼z draft kaydedilmedi';
          indicator.onclick = null;
          
          if (loadBtn) loadBtn.style.display = 'none';
        }
      },
      
      showDraftSelector: function() {
        const drafts = this.getAllDrafts();
        if (drafts.length === 0) {
          this.showNotification('KayÄ±tlÄ± draft bulunamadÄ±', 'info');
          return;
        }
        
        const modal = document.createElement('div');
        modal.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0,0,0,0.5);
          z-index: 4000;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 20px;
        `;
        
        let html = `
          <div style="
            background: white;
            border-radius: var(--radius);
            padding: 20px;
            max-width: 90%;
            max-height: 80vh;
            overflow: auto;
            box-shadow: var(--shadow);
            width: 500px;
          ">
            <h3 style="margin-top: 0; margin-bottom: 15px; color: var(--accent);">
              ğŸ“‚ KayÄ±tlÄ± Draft'lar
            </h3>
            <div style="margin-bottom: 20px; font-size: 13px; color: var(--muted);">
              Toplam ${drafts.length} draft. En son kaydedilenler Ã¼stte.
            </div>
        `;
        
        drafts.forEach((draft, index) => {
          const time = new Date(draft.timestamp).toLocaleString('tr-TR', {
            year: 'numeric',
            month: 'short',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
          });
          
          const preview = draft.autoCPR?.substring(0, 80) || 
                         draft.claim_problem?.substring(0, 80) || 
                         draft.feature?.substring(0, 80) || 
                         'BoÅŸ draft';
          
          html += `
            <div style="
              border: 1px solid var(--border);
              border-radius: 10px;
              padding: 12px;
              margin-bottom: 10px;
              cursor: pointer;
              transition: all 0.2s;
              background: ${index === 0 ? 'rgba(11, 95, 255, 0.03)' : 'white'};
            " 
            onclick="MobileFeatures.DraftSystem.loadDraft(${draft.id}); 
                     this.parentElement.parentElement.parentElement.remove();
                     MobileFeatures.showNotification('Draft yÃ¼klendi', 'success');"
            onmouseover="this.style.backgroundColor='var(--soft)'"
            onmouseout="this.style.backgroundColor='${index === 0 ? 'rgba(11, 95, 255, 0.03)' : 'white'}'">
              <div style="font-weight: bold; font-size: 14px; margin-bottom: 4px;">
                ${draft.name || `Draft ${index + 1}`}
                ${index === 0 ? '<span style="font-size: 11px; background: var(--ok); color: white; padding: 2px 6px; border-radius: 10px; margin-left: 8px;">EN SON</span>' : ''}
              </div>
              <div style="font-size: 11px; color: var(--muted); margin-bottom: 6px;">
                ${time}
              </div>
              <div style="font-size: 12px; color: #666; line-height: 1.4;">
                ${preview}${preview.length >= 80 ? '...' : ''}
              </div>
              <div style="margin-top: 8px; display: flex; gap: 8px; font-size: 11px;">
                <span style="background: var(--soft); padding: 2px 6px; border-radius: 10px;">
                  ${draft.claim_problem ? 'âœ” Claim' : 'âœ— Claim'}
                </span>
                <span style="background: var(--soft); padding: 2px 6px; border-radius: 10px;">
                  ${draft.feature ? 'âœ” Feature' : 'âœ— Feature'}
                </span>
                <span style="background: var(--soft); padding: 2px 6px; border-radius: 10px;">
                  ${draft.autoCPR ? 'âœ” CPR' : 'âœ— CPR'}
                </span>
              </div>
            </div>
          `;
        });
        
        html += `
          <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: space-between;">
            <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                    class="btn ghost" 
                    style="padding: 8px 16px;">
              Kapat
            </button>
            <button onclick="localStorage.removeItem('fastcpr_drafts_v2'); 
                             MobileFeatures.DraftSystem.updateDraftIndicator(); 
                             this.parentElement.parentElement.parentElement.remove(); 
                             MobileFeatures.showNotification('TÃ¼m draft\\'lar silindi', 'success');" 
                    class="btn" 
                    style="padding: 8px 16px; background: var(--bad);">
              TÃ¼mÃ¼nÃ¼ Sil
            </button>
          </div>
        `;
        
        html += '</div>';
        modal.innerHTML = html;
        document.body.appendChild(modal);
        
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            modal.remove();
          }
        });
      },
      
      showNotification: function(message, type = 'info') {
        MobileFeatures.showNotification(message, type);
      }
    },
    
    // 7. MOBÄ°L KLAVYE KISAYOLLARI
    KeyboardShortcuts: {
      templates: {
        claim: [
          "Hasta tedavisinde zaman kÄ±sÄ±tÄ± bulunuyor",
          "Klinik pratikte sÄ±k karÅŸÄ±laÅŸÄ±lan bir durum",
          "Mevcut tedavi seÃ§enekleri yetersiz kalÄ±yor",
          "Hasta uyumu konusunda zorluk yaÅŸanÄ±yor"
        ],
        feature: [
          "GeniÅŸ spektrumlu etkinlik profili",
          "Uzun yarÄ±lanma Ã¶mrÃ¼ ile gÃ¼nde tek doz",
          "Ä°yi tolere edilebilir yan etki profili",
          "Pratik kullanÄ±m sunan ambalaj tasarÄ±mÄ±"
        ],
        advantage: [
          "Benzerlerine gÃ¶re daha hÄ±zlÄ± etki baÅŸlangÄ±cÄ±",
          "Daha iyi gÃ¼venlik profili sunar",
          "Hasta konforunu artÄ±ran Ã¶zellikler",
          "Klinik etkinliÄŸi kanÄ±tlanmÄ±ÅŸ"
        ],
        benefit: [
          "Tedavi sÃ¼recini kÄ±saltÄ±r",
          "Hasta uyumunu artÄ±rÄ±r",
          "YaÅŸam kalitesini yÃ¼kseltir",
          "Klinik baÅŸarÄ± oranÄ±nÄ± iyileÅŸtirir"
        ],
        recommendation: [
          "Klinik pratiÄŸinizde deÄŸerlendirir misiniz?",
          "HastalarÄ±nÄ±z iÃ§in Ã¶nerir misiniz?",
          "Tedavi algoritmanÄ±za eklemeyi dÃ¼ÅŸÃ¼nÃ¼r mÃ¼sÃ¼nÃ¼z?",
          "Deneyimlerinizi paylaÅŸÄ±r mÄ±sÄ±nÄ±z?"
        ]
      },
      
      init: function() {
        const toolbar = document.getElementById('mobileToolbar');
        if (toolbar) {
          toolbar.style.display = window.innerWidth <= 768 ? 'flex' : 'none';
          
          window.addEventListener('resize', () => {
            toolbar.style.display = window.innerWidth <= 768 ? 'flex' : 'none';
          });
          
          toolbar.addEventListener('click', (e) => {
            const button = e.target.closest('button');
            if (button && button.dataset.action) {
              this.handleAction(button.dataset.action);
              button.classList.add('active');
              setTimeout(() => button.classList.remove('active'), 300);
            }
          });
        }
        
        document.querySelectorAll('textarea').forEach(textarea => {
          textarea.addEventListener('focus', () => {
            if (window.innerWidth <= 768 && toolbar) {
              toolbar.style.display = 'flex';
              setTimeout(() => {
                toolbar.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
              }, 100);
            }
          });
        });
        
        console.log('âœ… Mobil Toolbar + Åablon Sistemi hazÄ±r');
      },
      
      handleAction: function(action) {
        const activeTextarea = document.activeElement;
        if (!activeTextarea || activeTextarea.tagName !== 'TEXTAREA') {
          MobileFeatures.showNotification('Ã–nce bir metin alanÄ±na tÄ±klayÄ±n', 'info');
          return;
        }
        
        switch(action) {
          case 'claim':
          case 'feature':
          case 'advantage':
          case 'benefit':
          case 'recommendation':
            this.insertTemplate(activeTextarea, action);
            break;
            
          case 'copy':
            this.copyToClipboard(activeTextarea.value);
            break;
            
          case 'paste':
            this.pasteFromClipboard(activeTextarea);
            break;
            
          case 'clear':
            activeTextarea.value = '';
            activeTextarea.dispatchEvent(new Event('input', { bubbles: true }));
            break;
        }
      },
      
      insertTemplate: function(textarea, type) {
        const templates = this.templates[type];
        if (!templates) return;
        
        const randomTemplate = templates[Math.floor(Math.random() * templates.length)];
        const currentValue = textarea.value.trim();
        const separator = currentValue && !currentValue.endsWith('.') ? '. ' : ' ';
        textarea.value = currentValue + (currentValue ? separator : '') + randomTemplate;
        
        textarea.dispatchEvent(new Event('input', { bubbles: true }));
        textarea.focus();
        textarea.setSelectionRange(textarea.value.length, textarea.value.length);
        
        MobileFeatures.showNotification(`${type} ÅŸablonu eklendi`, 'success');
      },
      
      copyToClipboard: function(text) {
        if (!text.trim()) {
          MobileFeatures.showNotification('Kopyalanacak metin yok', 'warning');
          return;
        }
        
        navigator.clipboard.writeText(text).then(() => {
          MobileFeatures.showNotification('Metin panoya kopyalandÄ±', 'success');
        }).catch(err => {
          console.error('Kopyalama hatasÄ±:', err);
          MobileFeatures.showNotification('Kopyalama baÅŸarÄ±sÄ±z', 'error');
        });
      },
      
      pasteFromClipboard: async function(textarea) {
        try {
          const text = await navigator.clipboard.readText();
          if (text) {
            const currentValue = textarea.value;
            const cursorPos = textarea.selectionStart;
            const newValue = currentValue.substring(0, cursorPos) + text + currentValue.substring(cursorPos);
            textarea.value = newValue;
            textarea.dispatchEvent(new Event('input', { bubbles: true }));
            
            const newCursorPos = cursorPos + text.length;
            textarea.setSelectionRange(newCursorPos, newCursorPos);
            
            MobileFeatures.showNotification('Panodan yapÄ±ÅŸtÄ±rÄ±ldÄ±', 'success');
          }
        } catch (err) {
          console.error('YapÄ±ÅŸtÄ±rma hatasÄ±:', err);
          MobileFeatures.showNotification('YapÄ±ÅŸtÄ±rma baÅŸarÄ±sÄ±z', 'error');
        }
      }
    },
    
    // 8. TOAST BÄ°LDÄ°RÄ°M SÄ°STEMÄ°
    showNotification: function(message, type = 'info') {
      const area = document.getElementById('mobileNotificationArea');
      if (!area) return;
      
      const notification = document.createElement('div');
      notification.className = `mobile-notification ${type}`;
      
      let icon = 'â„¹ï¸';
      if (type === 'success') icon = 'âœ…';
      if (type === 'warning') icon = 'âš ï¸';
      if (type === 'error') icon = 'âŒ';
      if (type === 'info') icon = 'â„¹ï¸';
      
      notification.innerHTML = `
        <span class="icon">${icon}</span>
        <span class="message">${message}</span>
        <button class="close-btn" aria-label="Kapat">Ã—</button>
      `;
      
      area.appendChild(notification);
      
      notification.querySelector('.close-btn').addEventListener('click', () => {
        this.removeNotification(notification);
      });
      
      setTimeout(() => {
        this.removeNotification(notification);
      }, 4000);
      
      return notification;
    },
    
    removeNotification: function(notification) {
      if (!notification || !notification.parentNode) return;
      
      notification.style.opacity = '0';
      notification.style.transform = 'translateX(-50%) translateY(-10px)';
      notification.style.transition = 'opacity 0.3s, transform 0.3s';
      
      setTimeout(() => {
        if (notification.parentNode) {
          notification.parentNode.removeChild(notification);
        }
      }, 300);
    },
    
    // 9. TÃœM MOBÄ°L Ã–ZELLÄ°KLERÄ° BAÅLAT
    init: function() {
      console.log('ğŸ“± TÃœM FAZLAR: TÃ¼m sistemler yÃ¼kleniyor...');
      
      // SÄ±rayla baÅŸlat
      this.SpeechToText.init();
      this.ConnectivityManager.init();
      this.TextToSpeech.init();
      this.ClipboardSystem.init();
      this.PDFReportSystem.init();
      this.DraftSystem.init();
      this.KeyboardShortcuts.init();
      
      // BaÅŸlangÄ±Ã§ta toolbar'Ä± gÃ¶ster/gizle
      const toolbar = document.getElementById('mobileToolbar');
      if (toolbar) {
        toolbar.style.display = window.innerWidth <= 768 ? 'flex' : 'none';
        
        window.addEventListener('resize', () => {
          toolbar.style.display = window.innerWidth <= 768 ? 'flex' : 'none';
        });
      }
      
      console.log('âœ… TÃœM FAZLAR: TÃ¼m sistemler yÃ¼klendi!');
      console.log('ğŸ¤ FAZ 4: GeliÅŸmiÅŸ sesli giriÅŸ aktif');
      console.log('ğŸ“¡ FAZ 3: Connectivity Manager aktif');
      console.log('ğŸ”Š FAZ 3: Sesli okuma aktif');
      console.log('ğŸ“‹ FAZ 3: Kopyalama sistemi aktif');
      console.log('ğŸ“„ YENÄ°: KapsamlÄ± PDF Rapor sistemi aktif');
      console.log('ğŸ’¾ FAZ 2: Draft sistemi aktif');
      console.log('âŒ¨ï¸ FAZ 1: Klavye kÄ±sayollarÄ± aktif');
      
      // HoÅŸ geldin mesajÄ±
      if (window.innerWidth <= 768) {
        setTimeout(() => {
          this.showNotification('ğŸ“± TÃ¼m sistemler hazÄ±r! Sesli giriÅŸ, PDF rapor ve tÃ¼m Ã¶zellikler aktif.', 'success');
        }, 1000);
      }
    }
  };
  
  // ============================================
  // YENÄ°: TEMEL CPR AKIÅ KONTROL SÄ°STEMÄ°
  // ============================================
  
  const CPRFlowControl = {
    init: function() {
        this.setupHintSystem();
        this.setupFlowControl();
        this.setupClearButtons();
        this.enableAllFields(); // YENÄ° EKLENEN SATIR - TÃ¼m alanlarÄ± aÃ§
    },
    
    // YENÄ° EKLENEN METOD: TÃœM ALANLARI AKTÄ°F ET
    enableAllFields: function() {
        // TÃ¼m CPR alanlarÄ±nÄ± bul
        const cprTextareas = document.querySelectorAll('.cpr-section-card textarea, .styled-cpr-area');
        
        cprTextareas.forEach(textarea => {
            if (textarea) {
                textarea.disabled = false;
                textarea.readOnly = false;
                textarea.style.backgroundColor = '';
                textarea.style.color = '';
                textarea.style.cursor = 'text';
                textarea.style.opacity = '1';
                
                // Orijinal placeholder'larÄ± geri yÃ¼kle
                const id = textarea.id;
                const placeholders = {
                    'base_claim_problem': 'Klinik problemi yazÄ±n...',
                    'base_claim_effect': 'Bu problemin hasta, hekim veya sÃ¼reÃ§ Ã¼zerindeki etkisini yazÄ±n...',
                    'base_feat': 'Ã–rn: ÃœrÃ¼n X, gÃ¼nde tek doz kullanÄ±m ile hasta uyumunu artÄ±rÄ±r',
                    'base_adv': 'Ã–rn: Bu sayede benzer etki gÃ¶sterenlere gÃ¶re gÃ¼nde tek doz kullanÄ±lÄ±r',
                    'base_ben': 'Ã–rn: Tedavilerini aksatmadan devam ederler, iÅŸlerini yapmaktan geri kalmazlar',
                    'base_rec': 'Ã–rn: Bu tÃ¼r ataklarda, gÃ¼nde tek doz kullanÄ±lan X ile tedaviye bir an Ã¶nce baÅŸlamayÄ± tercih eder misiniz?',
                    'activist_cpr': 'Stile aktar butonuna basÄ±n veya buraya yazÄ±n... Aktivist CPR iÃ§in: hÄ±zlÄ±, dinamik, aksiyon odaklÄ± ifadeler kullanÄ±n.',
                    'reflector_cpr': 'Stile aktar butonuna basÄ±n veya buraya yazÄ±n... ReflektÃ¶r CPR iÃ§in: sakin, gÃ¶zleme dayalÄ±, veri referanslÄ± ifadeler kullanÄ±n.',
                    'theorist_cpr': 'Stile aktar butonuna basÄ±n veya buraya yazÄ±n... Teorist CPR iÃ§in: sistematik, kÄ±lavuz referanslÄ± ve mekanizma temelli ifadeler kullanÄ±n.',
                    'pragmatist_cpr': 'Stile aktar butonuna basÄ±n veya buraya yazÄ±n... Pragmatist CPR iÃ§in: Pratik, uygulanabilir, "nasÄ±l yapÄ±lÄ±r" odaklÄ± ifadeler kullanÄ±n.'
                };
                
                if (placeholders[id]) {
                    textarea.placeholder = placeholders[id];
                }
            }
        });
        
        console.log('âœ… TÃ¼m CPR alanlarÄ± aÃ§Ä±ldÄ± - Serbest yazÄ±m modu aktif');
    },
    
    setupHintSystem: function() {
        document.querySelectorAll('textarea').forEach(textarea => {
            const hintId = 'hint_' + textarea.id;
            const hintBox = document.getElementById(hintId);
            
            if (hintBox) {
                textarea.addEventListener('focus', () => {
                    hintBox.classList.add('show');
                });
                
                textarea.addEventListener('blur', () => {
                    hintBox.classList.remove('show');
                });
            }
        });
    },
    
    setupFlowControl: function() {
        const textareas = [
            'base_claim_problem', 'base_claim_effect', 
            'base_feat', 'base_adv', 'base_ben', 'base_rec'
        ];
        
        textareas.forEach(id => {
            const textarea = document.getElementById(id);
            if (textarea) {
                textarea.addEventListener('input', () => {
                    if (typeof AutoCPRGenerator !== 'undefined') {
                        AutoCPRGenerator.updateAutoCPR();
                    }
                });
            }
        });
    },
    
    setupClearButtons: function() {
        const clearButtons = {
            'clear_base_claim_problem': 'base_claim_problem',
            'clear_base_feat': 'base_feat',
            'clear_base_adv': 'base_adv',
            'clear_base_ben': 'base_ben',
            'clear_base_rec': 'base_rec'
        };
        
        Object.entries(clearButtons).forEach(([btnId, textareaId]) => {
            const btn = document.getElementById(btnId);
            const textarea = document.getElementById(textareaId);
            
            if (btn && textarea) {
                btn.addEventListener('click', () => {
                    textarea.value = '';
                    textarea.dispatchEvent(new Event('input', { bubbles: true }));
                    
                    if (typeof AutoCPRGenerator !== 'undefined') {
                        AutoCPRGenerator.updateAutoCPR();
                    }
                });
            }
        });
    },
    
    // BU METODU TAMAMEN SÄ°LEBÄ°LÄ°R veya BOÅ BIRAKABÄ°LÄ°RSÄ°NÄ°Z
    setupValidation: function() {
        // HiÃ§bir ÅŸey yapma - tÃ¼m alanlar aÃ§Ä±k kalacak
        console.log('ğŸ”“ DoÄŸrulama sistemi devre dÄ±ÅŸÄ± - tÃ¼m alanlar aÃ§Ä±k');
    },
    
    // BU METODLARI DA KAPATABÄ°LÄ°RSÄ°NÄ°Z
    validateAndToggleFields: function() {
        // HiÃ§bir ÅŸey yapma
    },
    
    validateClaim: function(problemText, effectText) {
        return true; // Her zaman true dÃ¶ndÃ¼r
    },
    
    validateMinWords: function(text, minWords) {
        return true; // Her zaman true dÃ¶ndÃ¼r
    },
    
    toggleField: function(fieldId, isEnabled, fieldName) {
        // HiÃ§bir ÅŸey yapma - tÃ¼m alanlar aÃ§Ä±k
        const textarea = document.getElementById(fieldId);
        if (textarea) {
            textarea.disabled = false;
            textarea.style.backgroundColor = '';
        }
    }
  };
  
  // ============================================
  // MEVCUT SÄ°STEM KODLARI
  // ============================================
  
  const MedicalTermsDictionary = { 
    'antibiyotik': ['enfeksiyon', 'bakteri', 'mikrop', 'tedavi'],
    'analjezik': ['aÄŸrÄ±', 'aÄŸrÄ± kesici', 'rahatlama'],
    'antiinflamatuar': ['iltihap', 'ÅŸiÅŸlik', 'kÄ±zarÄ±klÄ±k'],
    'antihipertansif': ['tansiyon', 'hipertansiyon', 'kan basÄ±ncÄ±'],
    'antipiretik': ['ateÅŸ', 'yÃ¼ksek ateÅŸ', 'ateÅŸ dÃ¼ÅŸÃ¼rÃ¼cÃ¼'],
    'antiseptik': ['mikrop', 'dezenfektan', 'temizlik'],
    'bronkodilatÃ¶r': ['nefes', 'solunum', 'astÄ±m'],
    'diÃ¼retik': ['idrar', 'Ã¶dem', 'ÅŸiÅŸlik'],
    'hipnotik': ['uyku', 'insomnia', 'uykusuzluk'],
    'kemoterapÃ¶tik': ['kanser', 'tÃ¼mÃ¶r', 'onkolojik'],
    'kortikosteroid': ['iltihap', 'alerji', 'baÄŸÄ±ÅŸÄ±klÄ±k'],
    'sedatif': ['sakinleÅŸtirici', 'anksiyete', 'stres'],
    'vitamin': ['takviye', 'destek', 'beslenme']
  };
  
  const UserBehaviorTracker = { 
    // Mevcut iÃ§erik korundu
  };
  
  // ============================
  // ÃœRÃœN ODAK & HAZIRLIK (Fener) - GÃœNCELLENDÄ° (BAÄIMSIZ SÄ°STEM)
  // ============================
  const ProductPrep = (function(){
    const KEY = 'fastcpr_productprep_v2'; // Yeni versiyon

    const QUICK_SUPERIORITY = [
      'Etkinlik Ã¼stÃ¼nlÃ¼ÄŸÃ¼',
      'GÃ¼venlilik profili',
      'GÃ¼nde tek doz kolaylÄ±ÄŸÄ±',
      'HÄ±zlÄ± etki baÅŸlangÄ±cÄ±',
      'Hasta uyumu / devamlÄ±lÄ±k',
      'Stabilite / ambalaj avantajÄ±',
      'GeniÅŸ spektrum / kapsayÄ±cÄ±lÄ±k'
    ];

    const QUICK_BENEFITS = [
      'Daha hÄ±zlÄ± rahatlama / iyileÅŸme',
      'GÃ¼nde tek doz ile kolay kullanÄ±m',
      'Tedaviye uyum ve devamlÄ±lÄ±k',
      'Klinik gÃ¼ven ve Ã¶ngÃ¶rÃ¼lebilirlik',
      'Daha az ziyaret / daha az yÃ¼k',
      'YaÅŸam kalitesi korunur',
      'Gereksiz antibiyotik deÄŸiÅŸimi azalÄ±r',
      'Pratik kullanÄ±m / uygulama kolaylÄ±ÄŸÄ±'
    ];

    let state = {
      products: [],          // BaÄŸÄ±msÄ±z Ã¼rÃ¼n listesi
      competitors: [],       // BaÄŸÄ±msÄ±z rakip listesi
      activeProduct: '',     // Aktif Ã¼rÃ¼n
      activeCompetitor: '',  // Aktif rakip (Ã¼rÃ¼nle baÄŸÄ±msÄ±z)
      superiority: '',       // ÃœstÃ¼n yÃ¶n
      benefits: [],          // SeÃ§ili faydalar
      benefitPool: []        // Eklenen faydalar
    };

    function load(){
      try{
        const raw = localStorage.getItem(KEY);
        if(raw){
          const parsed = JSON.parse(raw);
          if(parsed && typeof parsed === 'object') state = Object.assign(state, parsed);
        }
      }catch(e){}
    }

    function save(){
      try{ localStorage.setItem(KEY, JSON.stringify(state)); }catch(e){}
    }

    function titleCaseTR(input){
      const s = (input || '').trim().replace(/\s+/g,' ');
      if(!s) return '';
      return s.split(' ').map(w=>{
        const first = w.slice(0,1).toLocaleUpperCase('tr-TR');
        const rest  = w.slice(1).toLocaleLowerCase('tr-TR');
        return first + rest;
      }).join(' ');
    }

    // ÃœRÃœN FONKSÄ°YONLARI (BAÄIMSIZ)
    function setActiveProduct(name){
      state.activeProduct = name;
      save();
      render();
    }

    function addProduct(name){
      const n = titleCaseTR(name);
      if(!n) return;
      if(!state.products.includes(n)) state.products.unshift(n);
      state.activeProduct = n;
      save();
      render();
    }

    function removeProduct(name){
      state.products = state.products.filter(p=>p!==name);
      if(state.activeProduct === name) state.activeProduct = state.products[0] || '';
      save();
      render();
    }

    // RAKÄ°P FONKSÄ°YONLARI (BAÄIMSIZ)
    function setActiveCompetitor(name){
      state.activeCompetitor = name;
      save();
      renderCompetitors();
    }

    function addCompetitor(name){
      const n = titleCaseTR(name);
      if(!n) return;
      if(!state.competitors.includes(n)) state.competitors.unshift(n);
      state.activeCompetitor = n;
      save();
      renderCompetitors();
    }

    function removeCompetitor(name){
      state.competitors = state.competitors.filter(c=>c!==name);
      if(state.activeCompetitor === name) state.activeCompetitor = state.competitors[0] || '';
      save();
      renderCompetitors();
    }

    // ÃœSTÃœN YÃ–N
    function setSuperiority(text){
      state.superiority = (text || '').trim();
      save();
    }

    // FAYDA FONKSÄ°YONLARI
    function toggleBenefit(label){
      const idx = state.benefits.indexOf(label);
      if(idx >= 0){
        state.benefits.splice(idx,1);
      }else{
        if(state.benefits.length >= 2){
          MobileFeatures.showNotification('En fazla 2 fayda seÃ§ebilirsiniz.', 'warning');
          return;
        }
        state.benefits.push(label);
      }
      save();
      renderBenefits();
    }

    function clearBenefits(){
      state.benefits = [];
      save();
      renderBenefits();
    }

    function normalizeSentence(s){
      return (s || '')
        .trim()
        .replace(/\s+/g,' ')
        .replace(/^./, c=>c.toUpperCase());
    }

    function addCustomBenefit(raw){
      if(!raw) return;
      const label = normalizeSentence(raw);
      if(!label) return;

      const exists = state.benefitPool.some(x=>x.toLowerCase() === label.toLowerCase()) || 
                    QUICK_BENEFITS.some(x=>x.toLowerCase() === label.toLowerCase());
      if(!exists){
        state.benefitPool.unshift(label);
        if(state.benefitPool.length > 30) state.benefitPool = state.benefitPool.slice(0,30);
      }

      const already = state.benefits.some(x=>x.toLowerCase() === label.toLowerCase());
      if(!already && state.benefits.length < 2){
        state.benefits.push(label);
      }

      save();
      renderBenefits();
    }

    function el(id){ return document.getElementById(id); }

    function pill(label, opts){
      const d = document.createElement('div');
      d.className = 'pill ' + (opts.className || '');
      d.textContent = label;
      if(opts.onClick){
        d.classList.add('clickable');
        d.addEventListener('click', opts.onClick);
      }
      if(opts.onDblClick){
        d.addEventListener('dblclick', opts.onDblClick);
      }
      return d;
    }

    // YENÄ°: KALDIRMALI PILL
    function pillWithRemove(label, onRemove, isActive = false) {
      const d = document.createElement('div');
      d.className = 'pill removable clickable ' + (isActive ? 'active' : '');
      
      const textSpan = document.createElement('span');
      textSpan.textContent = label;
      textSpan.style.flex = '1';
      textSpan.style.marginRight = '4px';
      
      const removeBtn = document.createElement('span');
      removeBtn.className = 'x';
      removeBtn.textContent = 'Ã—';
      removeBtn.title = 'KaldÄ±r';
      removeBtn.style.cursor = 'pointer';
      removeBtn.style.fontWeight = 'bold';
      removeBtn.style.opacity = '0.7';
      removeBtn.style.marginLeft = '4px';
      removeBtn.style.padding = '0 2px';
      removeBtn.style.borderRadius = '50%';
      removeBtn.style.width = '16px';
      removeBtn.style.height = '16px';
      removeBtn.style.display = 'flex';
      removeBtn.style.alignItems = 'center';
      removeBtn.style.justifyContent = 'center';
      removeBtn.style.backgroundColor = 'rgba(0,0,0,0.05)';
      
      removeBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        onRemove();
      });
      
      removeBtn.addEventListener('mouseenter', () => {
        removeBtn.style.backgroundColor = 'rgba(239, 68, 68, 0.2)';
        removeBtn.style.opacity = '1';
      });
      
      removeBtn.addEventListener('mouseleave', () => {
        removeBtn.style.backgroundColor = 'rgba(0,0,0,0.05)';
        removeBtn.style.opacity = '0.7';
      });
      
      d.appendChild(textSpan);
      d.appendChild(removeBtn);
      
      return d;
    }

    function pillRemovable(label, onRemove){
      const d = document.createElement('div');
      d.className = 'pill clickable removable selected';
      const t = document.createElement('span');
      t.textContent = label;
      const x = document.createElement('span');
      x.className = 'x';
      x.textContent = 'Ã—';
      x.title = 'KaldÄ±r';
      x.addEventListener('click', (e)=>{ e.stopPropagation(); onRemove(); });
      d.appendChild(t);
      d.appendChild(x);
      return d;
    }

    // BAÄIMSIZ ÃœRÃœN RENDER
    function renderProducts(){
      const wrap = el('productPills');
      const label = el('activeProductLabel');
      if(!wrap || !label) return;

      wrap.innerHTML = '';
      label.textContent = 'SeÃ§ilen Ã¼rÃ¼n: ' + (state.activeProduct || 'â€”');

      state.products.forEach(p=>{
        const d = pillWithRemove(p, 
          () => removeProduct(p), 
          p === state.activeProduct
        );
        
        d.addEventListener('click', (e) => {
          if (!e.target.classList.contains('x')) {
            setActiveProduct(p);
          }
        });
        
        wrap.appendChild(d);
      });
    }

    // BAÄIMSIZ RAKÄ°P RENDER
    function renderCompetitors(){
      const wrap = el('competitorPills');
      const label = el('activeCompetitorLabel');
      if(!wrap || !label) return;

      wrap.innerHTML = '';
      label.textContent = 'SeÃ§ilen rakip: ' + (state.activeCompetitor || 'â€”');

      state.competitors.forEach(c=>{
        const d = pillWithRemove(c, 
          () => removeCompetitor(c), 
          c === state.activeCompetitor
        );
        
        d.addEventListener('click', (e) => {
          if (!e.target.classList.contains('x')) {
            setActiveCompetitor(c);
          }
        });
        
        wrap.appendChild(d);
      });
    }

    function renderSuperiority(){
      const wrap = el('superiorityPills');
      const input = el('superiorityInput');
      if(!wrap || !input) return;

      wrap.innerHTML = '';
      QUICK_SUPERIORITY.forEach(s=>{
        const d = pill(s, {
          className: 'clickable',
          onClick: ()=>{
            input.value = s;
            setSuperiority(s);
          }
        });
        wrap.appendChild(d);
      });

      input.value = state.superiority || '';
      input.addEventListener('input', ()=>setSuperiority(input.value));
    }

    function renderBenefits(){
      const opts = el('benefitOptions');
      const sel = el('benefitSelected');
      const clearBtn = el('clearBenefitsBtn');
      if(!opts || !sel) return;

      opts.innerHTML = '';
      sel.innerHTML = '';

      const selected = state.benefits || [];
      const pool = Array.from(new Set([
        ...QUICK_BENEFITS,
        ...(state.benefitPool || [])
      ]));

      pool.forEach(b=>{
        const isSel = selected.includes(b);
        const limitReached = selected.length >= 2;
        const d = pill(b, {
          className: 'clickable ' + (isSel ? 'selected' : '') + ((limitReached && !isSel) ? '' : ''),
          onClick: ()=>{
            if(limitReached && !isSel){
              MobileFeatures.showNotification('En fazla 2 fayda seÃ§ebilirsiniz.', 'warning');
              return;
            }
            toggleBenefit(b);
          }
        });
        opts.appendChild(d);
      });

      selected.forEach(b=>{
        sel.appendChild(pillRemovable(b, ()=>toggleBenefit(b)));
      });

      const benefitTextArea = el('benefitTextArea');
      if(benefitTextArea){
        benefitTextArea.value = selected.join(' / ');
        benefitTextArea.readOnly = true;
      }

      const addBenefitBtn = el('addBenefitBtn');
      const benefitInput = el('benefitCustomInput');
      
      if(addBenefitBtn && benefitInput){
        addBenefitBtn.addEventListener('click', ()=>{
          addCustomBenefit(benefitInput.value);
          benefitInput.value = '';
          benefitInput.blur();
        });
        benefitInput.addEventListener('keydown', (e)=>{
          if(e.key === 'Enter'){ e.preventDefault(); addBenefitBtn.click(); }
        });
      }

      if(clearBtn){
        clearBtn.disabled = selected.length===0;
      }
    }

    function bind(){
      const addProductBtn = el('addProductBtn');
      const productInput = el('productNameInput');
      const addCompetitorBtn = el('addCompetitorBtn');
      const competitorInput = el('competitorNameInput');
      const clearBtn = el('clearBenefitsBtn');
      const addBenefitBtn = el('addBenefitBtn');
      const benefitInput = el('benefitCustomInput');

      if(addProductBtn && productInput){
        addProductBtn.addEventListener('click', ()=>{
          addProduct(productInput.value);
          productInput.value = '';
          productInput.blur();
        });
        productInput.addEventListener('keydown', (e)=>{
          if(e.key === 'Enter'){ e.preventDefault(); addProductBtn.click(); }
        });
      }

      if(addCompetitorBtn && competitorInput){
        addCompetitorBtn.addEventListener('click', ()=>{
          addCompetitor(competitorInput.value);
          competitorInput.value = '';
          competitorInput.blur();
        });
        competitorInput.addEventListener('keydown', (e)=>{
          if(e.key === 'Enter'){ e.preventDefault(); addCompetitorBtn.click(); }
        });
      }

      if(clearBtn){
        clearBtn.addEventListener('click', clearBenefits);
      }
    }

    function render(){
      renderProducts();
      renderCompetitors();
      renderSuperiority();
      renderBenefits();
    }

    function init(){
      load();
      bind();
      if(!state.activeProduct && state.products.length) state.activeProduct = state.products[0];
      if(!state.activeCompetitor && state.competitors.length) state.activeCompetitor = state.competitors[0];
      render();
      
      console.log('âœ… BaÄŸÄ±msÄ±z ÃœrÃ¼n/Rakip sistemi hazÄ±r');
      console.log('ğŸ”“ ÃœrÃ¼n ve rakipler baÄŸÄ±msÄ±z');
      console.log('âŒ ÃœrÃ¼n silince rakipler etkilenmez');
      console.log('âŒ Rakip silince Ã¼rÃ¼nler etkilenmez');
    }

    return { 
      init,
      getState: () => state,
      addProduct,
      removeProduct,
      addCompetitor,
      removeCompetitor
    };
  })();

  // TÃœM SÄ°STEMLERÄ° BAÅLAT - GÃœNCELLENDÄ°
  document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸš€ FAST CPR KOÃ‡U - TÃœM FAZLAR baÅŸlatÄ±lÄ±yor...');
    
    // 1. Ã–nce Otomatik CPR Ãœretim Sistemini baÅŸlat
    AutoCPRGenerator.init();
    
    // 2. TÃ¼m mobil Ã¶zellikleri baÅŸlat
    MobileFeatures.init();
    
    // 3. Mevcut sistemleri baÅŸlat
    CPRFlowControl.init();
    
    try { 
      ProductPrep.init(); 
    } catch(e) { 
      console.warn('ProductPrep init failed', e); 
    }
    
    // 4. Ses butonlarÄ±nÄ± baÄŸla
    document.querySelectorAll('.voice-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        const targetId = btn.getAttribute('data-target');
        if (targetId && MobileFeatures.SpeechToText) {
          MobileFeatures.SpeechToText.toggleListening(targetId);
        }
      });
    });
    
    // 5. Kopyala butonunu baÄŸla
    const copyBtn = document.getElementById('copyCPR');
    if (copyBtn) {
      copyBtn.addEventListener('click', () => {
        MobileFeatures.ClipboardSystem.copyCPRToClipboard();
      });
    }
    
    // 6. Sesli Oku butonunu baÄŸla
    const voiceReadBtn = document.getElementById('voiceReadCPR');
    if (voiceReadBtn) {
      voiceReadBtn.addEventListener('click', () => {
        MobileFeatures.TextToSpeech.readCPR();
      });
    }
    
    // 7. YENÄ° TÃœM RAPOR PDF BUTONUNU BAÄLA
    const fullReportBtn = document.getElementById('fullReportPDF');
    if (fullReportBtn) {
      fullReportBtn.addEventListener('click', () => {
        ComprehensivePDFReport.generateFullReport();
      });
      
      // Hover efekti ekle
      fullReportBtn.addEventListener('mouseenter', () => {
        if (!fullReportBtn.innerHTML.includes('OluÅŸturuluyor')) {
          fullReportBtn.style.background = '#2563eb';
          fullReportBtn.style.transform = 'scale(1.02)';
        }
      });
      
      fullReportBtn.addEventListener('mouseleave', () => {
        if (!fullReportBtn.innerHTML.includes('OluÅŸturuluyor')) {
          fullReportBtn.style.background = '#3b82f6';
          fullReportBtn.style.transform = 'scale(1)';
        }
      });
    }
    
    // 8. Hint-box'larÄ± baÄŸla
    document.querySelectorAll('textarea').forEach(textarea => {
      const hintId = 'hint_' + textarea.id;
      const hintBox = document.getElementById(hintId);
      
      if (hintBox) {
        textarea.addEventListener('focus', () => {
          hintBox.classList.add('show');
        });
        
        textarea.addEventListener('blur', () => {
          hintBox.classList.remove('show');
        });
      }
    });
    
    // 9. Clear butonlarÄ±nÄ± baÄŸla
    document.querySelectorAll('[id^="clear_base_"]').forEach(btn => {
      btn.addEventListener('click', function() {
        const targetId = this.id.replace('clear_', '');
        const textarea = document.getElementById(targetId);
        if (textarea) {
          textarea.value = '';
          textarea.dispatchEvent(new Event('input'));
        }
      });
    });
    
    // 10. EKSTRA GÃœVENLÄ°K: TÃœM ALANLARI TEKRAR AÃ‡ (gÃ¼vence iÃ§in)
    setTimeout(() => {
        // TÃ¼m CPR ve stil textarea'larÄ±nÄ± bul
        const allTextareas = document.querySelectorAll('.cpr-section-card textarea, .styled-cpr-area');
        
        allTextareas.forEach(textarea => {
            // Her zaman aÃ§Ä±k ve yazÄ±labilir yap
            textarea.disabled = false;
            textarea.readOnly = false;
            textarea.style.backgroundColor = '';
            textarea.style.color = '';
            textarea.style.cursor = 'text';
            textarea.style.opacity = '1';
        });
        
        console.log('âœ… Ekstra gÃ¼venlik: TÃ¼m alanlar tekrar kontrol edildi ve aÃ§Ä±ldÄ±');
        
        // KullanÄ±cÄ±ya bildir
        if (typeof MobileFeatures !== 'undefined' && MobileFeatures.showNotification) {
            MobileFeatures.showNotification('TÃ¼m CPR alanlarÄ± aÃ§Ä±ldÄ± - Ä°stediÄŸiniz sÄ±rada yazabilirsiniz', 'success');
        }
    }, 2000);
    
    console.log('âœ… TÃœM FAZLAR TAMAMLANDI!');
    console.log('ğŸ¯ FAZ 1: Temel CPR + Otomatik Ã–zet');
    console.log('ğŸ’¾ FAZ 2: Draft Sistemi');
    console.log('ğŸ“¡ FAZ 3: Connectivity Manager + Sesli Okuma + Kopyalama');
    console.log('ğŸ¤ FAZ 4: GeliÅŸmiÅŸ Sesli GiriÅŸ');
    console.log('ğŸ“„ YENÄ°: KapsamlÄ± TÃ¼m Rapor PDF Sistemi');
    console.log('ğŸ”“ Ã–ZEL: TÃ¼m alanlar ÅŸartsÄ±z aÃ§Ä±k');
    console.log('ğŸ”„ YENÄ°: ÃœrÃ¼n ve rakip sistemleri BAÄIMSIZ');
    console.log('âœ… ÃœrÃ¼n eklenmeden rakip eklenebilir');
    console.log('âœ… Rakip eklenmeden Ã¼rÃ¼n eklenebilir');
    console.log('âœ… ÃœrÃ¼n silince rakipler kalÄ±r');
    console.log('âœ… Rakip silince Ã¼rÃ¼nler kalÄ±r');
    console.log('âŒ KaldÄ±rma Ã¶zelliÄŸi aktif');
    
    // BaÅŸlangÄ±Ã§ kontrolÃ¼
    setTimeout(() => {
      if (!navigator.onLine) {
        MobileFeatures.showNotification('Ã‡evrimdÄ±ÅŸÄ± moddasÄ±nÄ±z. Ã‡alÄ±ÅŸmalarÄ±nÄ±z yerelde kaydedilecek.', 'warning');
      }
      
      const drafts = MobileFeatures.DraftSystem.getAllDrafts();
      if (drafts.length > 0) {
        console.log(`ğŸ“Š ${drafts.length} kayÄ±tlÄ± draft bulundu`);
        MobileFeatures.showNotification(`${drafts.length} kayÄ±tlÄ± draft bulundu. "Draft Listesi" butonundan yÃ¼kleyebilirsiniz.`, 'info');
      }
      
      // AutoCPR'i baÅŸlangÄ±Ã§ta gÃ¼ncelle
      AutoCPRGenerator.updateAutoCPR();
    }, 500);
  });

</script>
</body>
</html>
